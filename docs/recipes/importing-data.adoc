== Importing data

Couchbase Shell supports loading data from a variety of formats and sources.
The simplest way to import data is using `doc import` as covered in xref:docs.adoc#_loading_data_into_the_shell[Loading data into the shell].
These recipes will cover more advanced use cases, importing data from a variety of formats.

=== From JSON

Imagine we have the following json document saved locally:
```
ðŸ‘¤ Charlie ðŸ  local in ðŸ—„ default._default._default
> open mydoc.json
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ id          â”‚ 3719                â”‚
â”‚ cas         â”‚ 1600344369374167040 â”‚
â”‚ type        â”‚ airport             â”‚
â”‚ airportname â”‚ Columbia Rgnl       â”‚
â”‚ city        â”‚ Columbia            â”‚
â”‚ country     â”‚ United States       â”‚
â”‚ faa         â”‚ COU                 â”‚
â”‚ icao        â”‚ KCOU                â”‚
â”‚ tz          â”‚ America/Chicago     â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
```

Before we can use https://couchbase.sh/docs/#_doc_upsert[doc upsert] to save this to the connected cluster we need to format it appropriately, see https://couchbase.sh/docs/#_manual_import[manual import] for an explanation.

```
ðŸ‘¤ Charlie ðŸ  local in ðŸ—„ default._default._default
> open mydoc.json | wrap content | insert id $in.content.id | doc upsert
â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ # â”‚ processed â”‚ success â”‚ failed â”‚ failures â”‚ cluster â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0 â”‚         1 â”‚       1 â”‚      0 â”‚          â”‚ local   â”‚
â•°â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
```

We can then get this doc using the id it was inserted with:

```
ðŸ‘¤ Charlie ðŸ  local in ðŸ—„ default._default._default
> doc get 3719
â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ # â”‚  id  â”‚                content                â”‚         cas         â”‚ error â”‚ cluster â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0 â”‚ 3719 â”‚ â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•® â”‚ 1727255692390236160 â”‚       â”‚ local   â”‚
â”‚   â”‚      â”‚ â”‚ id          â”‚ 3719                â”‚ â”‚                     â”‚       â”‚         â”‚
â”‚   â”‚      â”‚ â”‚ cas         â”‚ 1600344369374167040 â”‚ â”‚                     â”‚       â”‚         â”‚
â”‚   â”‚      â”‚ â”‚ type        â”‚ airport             â”‚ â”‚                     â”‚       â”‚         â”‚
â”‚   â”‚      â”‚ â”‚ airportname â”‚ Columbia Rgnl       â”‚ â”‚                     â”‚       â”‚         â”‚
â”‚   â”‚      â”‚ â”‚ city        â”‚ Columbia            â”‚ â”‚                     â”‚       â”‚         â”‚
â”‚   â”‚      â”‚ â”‚ country     â”‚ United States       â”‚ â”‚                     â”‚       â”‚         â”‚
â”‚   â”‚      â”‚ â”‚ faa         â”‚ COU                 â”‚ â”‚                     â”‚       â”‚         â”‚
â”‚   â”‚      â”‚ â”‚ icao        â”‚ KCOU                â”‚ â”‚                     â”‚       â”‚         â”‚
â”‚   â”‚      â”‚ â”‚ tz          â”‚ America/Chicago     â”‚ â”‚                     â”‚       â”‚         â”‚
â”‚   â”‚      â”‚ â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯ â”‚                     â”‚       â”‚         â”‚
â•°â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
```

We usually have more than one document, say we have a directory named `airports` containing a set of json docs:

```
ðŸ‘¤ Charlie ðŸ  local in ðŸ—„ default._default._default
> ls airports
â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ # â”‚            name            â”‚ type â”‚ size  â”‚   modified    â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0 â”‚ airports/airport_3719.json â”‚ file â”‚ 353 B â”‚ 3 minutes ago â”‚
â”‚ 1 â”‚ airports/airport_3720.json â”‚ file â”‚ 355 B â”‚ 3 minutes ago â”‚
â”‚ 2 â”‚ airports/airport_3721.json â”‚ file â”‚ 370 B â”‚ 3 minutes ago â”‚
â”‚ 3 â”‚ airports/airport_3722.json â”‚ file â”‚ 362 B â”‚ 2 minutes ago â”‚
â”‚ 4 â”‚ airports/airport_3723.json â”‚ file â”‚ 365 B â”‚ 2 minutes ago â”‚
â”‚ 5 â”‚ airports/airport_3724.json â”‚ file â”‚ 356 B â”‚ 2 minutes ago â”‚
â”‚ 6 â”‚ airports/airport_3725.json â”‚ file â”‚ 350 B â”‚ 2 minutes ago â”‚
â”‚ 7 â”‚ airports/airport_3726.json â”‚ file â”‚ 362 B â”‚ 2 minutes ago â”‚
â”‚ 8 â”‚ airports/airport_3727.json â”‚ file â”‚ 371 B â”‚ 2 minutes ago â”‚
â”‚ 9 â”‚ airports/airport_3728.json â”‚ file â”‚ 354 B â”‚ 2 minutes ago â”‚
â•°â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
```

Where each of the docs has a schema like this:

```
ðŸ‘¤ Charlie ðŸ  local in ðŸ—„ default._default._default
> open airports/airport_3719.json
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ id          â”‚ 3719             â”‚
â”‚ type        â”‚ airport          â”‚
â”‚ airportname â”‚ Columbia Rgnl    â”‚
â”‚ city        â”‚ Columbia         â”‚
â”‚ country     â”‚ United States    â”‚
â”‚ faa         â”‚ COU              â”‚
â”‚ icao        â”‚ KCOU             â”‚
â”‚ tz          â”‚ America/Chicago  â”‚
â”‚             â”‚ â•­â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â•® â”‚
â”‚ geo         â”‚ â”‚ lat â”‚ 38.82  â”‚ â”‚
â”‚             â”‚ â”‚ lon â”‚ -92.22 â”‚ â”‚
â”‚             â”‚ â”‚ alt â”‚ 889    â”‚ â”‚
â”‚             â”‚ â•°â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â•¯ â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
```

We can use Nushell's https://www.nushell.sh/commands/docs/each.html[each] to iterate over the output of the `ls` command, format each document, and upsert to the connected cluster:

```
ðŸ‘¤ Charlie ðŸ  local in ðŸ—„ default._default._default
> ls airports | each { |it| open $it.name | wrap content | insert id $in.content.airportname } | doc upsert
â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ # â”‚ processed â”‚ success â”‚ failed â”‚ failures â”‚ cluster â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0 â”‚        10 â”‚      10 â”‚      0 â”‚          â”‚ local   â”‚
â•°â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
```

Notice that here we have used the `airportname` field of the docs as the id, instead of the id field.
So if we want to get the contents of `airports/airport_3719.json` from the cluster we would need to use the `airportname`:

```
ðŸ‘¤ Charlie ðŸ  local in ðŸ—„ default._default._default
> doc get "Columbia Rgnl"
â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ # â”‚      id       â”‚              content               â”‚         cas         â”‚ error â”‚ cluster â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0 â”‚ Columbia Rgnl â”‚ â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•® â”‚ 1727255637891874816 â”‚       â”‚ local   â”‚
â”‚   â”‚               â”‚ â”‚ id          â”‚ 3719             â”‚ â”‚                     â”‚       â”‚         â”‚
â”‚   â”‚               â”‚ â”‚ type        â”‚ airport          â”‚ â”‚                     â”‚       â”‚         â”‚
â”‚   â”‚               â”‚ â”‚ airportname â”‚ Columbia Rgnl    â”‚ â”‚                     â”‚       â”‚         â”‚
â”‚   â”‚               â”‚ â”‚ city        â”‚ Columbia         â”‚ â”‚                     â”‚       â”‚         â”‚
â”‚   â”‚               â”‚ â”‚ country     â”‚ United States    â”‚ â”‚                     â”‚       â”‚         â”‚
â”‚   â”‚               â”‚ â”‚ faa         â”‚ COU              â”‚ â”‚                     â”‚       â”‚         â”‚
â”‚   â”‚               â”‚ â”‚ icao        â”‚ KCOU             â”‚ â”‚                     â”‚       â”‚         â”‚
â”‚   â”‚               â”‚ â”‚ tz          â”‚ America/Chicago  â”‚ â”‚                     â”‚       â”‚         â”‚
â”‚   â”‚               â”‚ â”‚             â”‚ â•­â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â•® â”‚ â”‚                     â”‚       â”‚         â”‚
â”‚   â”‚               â”‚ â”‚ geo         â”‚ â”‚ lat â”‚ 38.82  â”‚ â”‚ â”‚                     â”‚       â”‚         â”‚
â”‚   â”‚               â”‚ â”‚             â”‚ â”‚ lon â”‚ -92.22 â”‚ â”‚ â”‚                     â”‚       â”‚         â”‚
â”‚   â”‚               â”‚ â”‚             â”‚ â”‚ alt â”‚ 889    â”‚ â”‚ â”‚                     â”‚       â”‚         â”‚
â”‚   â”‚               â”‚ â”‚             â”‚ â•°â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â•¯ â”‚ â”‚                     â”‚       â”‚         â”‚
â”‚   â”‚               â”‚ â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯ â”‚                     â”‚       â”‚         â”‚
â•°â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
```

Using `doc upsert` in this way gives you much more control over the data saved compared to the `doc import` command.
For example we can even combine fields to form the id:

```
ðŸ‘¤ Charlie ðŸ  local in ðŸ—„ default._default._default
> ls airports | each { |it| open $it.name | wrap content | insert id ([$in.content.type $in.content.id] | str join "_") } | doc upsert
â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ # â”‚ processed â”‚ success â”‚ failed â”‚ failures â”‚ cluster â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0 â”‚        10 â”‚      10 â”‚      0 â”‚          â”‚ local   â”‚
â•°â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
```

Here we have used Nushell's https://www.nushell.sh/commands/docs/str_join.html[str join] to join the `type` and `id` field of each document with "_".

```
ðŸ‘¤ Charlie ðŸ  local in ðŸ—„ default._default._default
> doc get airport_3719
â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ # â”‚      id      â”‚              content               â”‚         cas         â”‚ error â”‚ cluster â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0 â”‚ airport_3719 â”‚ â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•® â”‚ 1727255862736125952 â”‚       â”‚ local   â”‚
â”‚   â”‚              â”‚ â”‚ id          â”‚ 3719             â”‚ â”‚                     â”‚       â”‚         â”‚
â”‚   â”‚              â”‚ â”‚ type        â”‚ airport          â”‚ â”‚                     â”‚       â”‚         â”‚
â”‚   â”‚              â”‚ â”‚ airportname â”‚ Columbia Rgnl    â”‚ â”‚                     â”‚       â”‚         â”‚
â”‚   â”‚              â”‚ â”‚ city        â”‚ Columbia         â”‚ â”‚                     â”‚       â”‚         â”‚
â”‚   â”‚              â”‚ â”‚ country     â”‚ United States    â”‚ â”‚                     â”‚       â”‚         â”‚
â”‚   â”‚              â”‚ â”‚ faa         â”‚ COU              â”‚ â”‚                     â”‚       â”‚         â”‚
â”‚   â”‚              â”‚ â”‚ icao        â”‚ KCOU             â”‚ â”‚                     â”‚       â”‚         â”‚
â”‚   â”‚              â”‚ â”‚ tz          â”‚ America/Chicago  â”‚ â”‚                     â”‚       â”‚         â”‚
â”‚   â”‚              â”‚ â”‚             â”‚ â•­â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â•® â”‚ â”‚                     â”‚       â”‚         â”‚
â”‚   â”‚              â”‚ â”‚ geo         â”‚ â”‚ lat â”‚ 38.82  â”‚ â”‚ â”‚                     â”‚       â”‚         â”‚
â”‚   â”‚              â”‚ â”‚             â”‚ â”‚ lon â”‚ -92.22 â”‚ â”‚ â”‚                     â”‚       â”‚         â”‚
â”‚   â”‚              â”‚ â”‚             â”‚ â”‚ alt â”‚ 889    â”‚ â”‚ â”‚                     â”‚       â”‚         â”‚
â”‚   â”‚              â”‚ â”‚             â”‚ â•°â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â•¯ â”‚ â”‚                     â”‚       â”‚         â”‚
â”‚   â”‚              â”‚ â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯ â”‚                     â”‚       â”‚         â”‚
â•°â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
```

=== From CSV

Nushell also supports csv, as well as JSON, say we have the following CSV document saved locally:

[options="nowrap"]
```
ðŸ‘¤ Charlie ðŸ  local in ðŸ—„ default._default._default
> open mydoc.csv
â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ # â”‚  id  â”‚         cas         â”‚  type   â”‚  airportname  â”‚   city   â”‚    country    â”‚ faa â”‚ icao â”‚       tz        â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0 â”‚ 3719 â”‚ 1600344369374167040 â”‚ airport â”‚ Columbia Rgnl â”‚ Columbia â”‚ United States â”‚ COU â”‚ KCOU â”‚ America/Chicago â”‚
â•°â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
```

As with JSON we can import this to the connected Cluster with `doc upsert` once we do the see https://couchbase.sh/docs/#_manual_import[appropriate formatting].

```
ðŸ‘¤ Charlie ðŸ  local in ðŸ—„ default._default._default
> open mydoc.csv | wrap content | insert id $in.content.id.0 | doc upsert
â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ # â”‚ processed â”‚ success â”‚ failed â”‚ failures â”‚ cluster â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0 â”‚         1 â”‚       1 â”‚      0 â”‚          â”‚ local   â”‚
â•°â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
```

We access the id field in a slightly different way (`$in.content.id.0`) because of the format of the doc when opened.
`$in.content.id` returns a list of length 1 in this case:

```
ðŸ‘¤ Charlie ðŸ  local in ðŸ—„ default._default._default
> open mydoc.csv | wrap content | insert id $in.content.id
â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â•®
â”‚ 0 â”‚ 3719 â”‚
â•°â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â•¯
```

Therefore we need to get the first element (at index 0) using `.0`, since ids must be strings or ints, not lists:

```
ðŸ‘¤ Charlie ðŸ  local in ðŸ—„ default._default._default
> open mydoc.csv | wrap content | $in.content.id.0
3719
```

We can also import multiple csv documents as follows:

```
> cat airports.csv
airportname,city,country,faa,icao,id,type,tz
Calais Dunkerque,Calais,France,CQF,LFAC,1254,airport,Europe/Paris
Peronne St Quentin,Peronne,France,,LFAG,1255,airport,Europe/Paris
Les Loges,Nangis,France,,LFAI,1256,airport,Europe/Paris
Couterne,Bagnole-de-l'orne,France,,LFAO,1257,airport,Europe/Paris
Bray,Albert,France,,LFAQ,1258,airport,Europe/Paris

> open airports.csv | each { |it| wrap content | insert id $in.content.id} | doc upsert
â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ # â”‚ processed â”‚ success â”‚ failed â”‚ failures â”‚ cluster â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0 â”‚         5 â”‚       5 â”‚      0 â”‚          â”‚ local   â”‚
â•°â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
```

Note that here we did not need to do `$in.content.id.0` because we are iterating over each entry, so `$in.content.id` returns an int, not a list of ints.

=== Modifying data

In some circumstances you may want to modify the data before you import it.
Let's take the example of importing from a csv file but this time the airports.csv file is missing the `type` column but we want to add it to our data:

```
> cat airports.csv
airportname,city,country,faa,icao,id,tz
Calais Dunkerque,Calais,France,CQF,LFAC,1254,Europe/Paris
Peronne St Quentin,Peronne,France,,LFAG,1255,Europe/Paris
Les Loges,Nangis,France,,LFAI,1256,Europe/Paris
Couterne,Bagnole-de-l'orne,France,,LFAO,1257,Europe/Paris
Bray,Albert,France,,LFAQ,1258,Europe/Paris

> open airports.csv | insert type airport
â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ # â”‚    airportname     â”‚       city        â”‚ country â”‚ faa â”‚ icao â”‚  id  â”‚      tz      â”‚  type   â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0 â”‚ Calais Dunkerque   â”‚ Calais            â”‚ France  â”‚ CQF â”‚ LFAC â”‚ 1254 â”‚ Europe/Paris â”‚ airport â”‚
â”‚ 1 â”‚ Peronne St Quentin â”‚ Peronne           â”‚ France  â”‚     â”‚ LFAG â”‚ 1255 â”‚ Europe/Paris â”‚ airport â”‚
â”‚ 2 â”‚ Les Loges          â”‚ Nangis            â”‚ France  â”‚     â”‚ LFAI â”‚ 1256 â”‚ Europe/Paris â”‚ airport â”‚
â”‚ 3 â”‚ Couterne           â”‚ Bagnole-de-l'orne â”‚ France  â”‚     â”‚ LFAO â”‚ 1257 â”‚ Europe/Paris â”‚ airport â”‚
â”‚ 4 â”‚ Bray               â”‚ Albert            â”‚ France  â”‚     â”‚ LFAQ â”‚ 1258 â”‚ Europe/Paris â”‚ airport â”‚
â•°â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
```

Here we have used Nushell's https://www.nushell.sh/commands/docs/insert.html[insert] to add a column to the whole table, instead of altering one row at a time.
We can also add a column based on data from other columns, for instance adding a `type` column which is set to the relevant country:

[options="nowrap"]
```
> open airports.csv | each { |it| insert type $it.city }
â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ # â”‚    airportname     â”‚       city        â”‚ country â”‚ faa â”‚ icao â”‚  id  â”‚      tz      â”‚       type        â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0 â”‚ Calais Dunkerque   â”‚ Calais            â”‚ France  â”‚ CQF â”‚ LFAC â”‚ 1254 â”‚ Europe/Paris â”‚ Calais            â”‚
â”‚ 1 â”‚ Peronne St Quentin â”‚ Peronne           â”‚ France  â”‚     â”‚ LFAG â”‚ 1255 â”‚ Europe/Paris â”‚ Peronne           â”‚
â”‚ 2 â”‚ Les Loges          â”‚ Nangis            â”‚ France  â”‚     â”‚ LFAI â”‚ 1256 â”‚ Europe/Paris â”‚ Nangis            â”‚
â”‚ 3 â”‚ Couterne           â”‚ Bagnole-de-l'orne â”‚ France  â”‚     â”‚ LFAO â”‚ 1257 â”‚ Europe/Paris â”‚ Bagnole-de-l'orne â”‚
â”‚ 4 â”‚ Bray               â”‚ Albert            â”‚ France  â”‚     â”‚ LFAQ â”‚ 1258 â”‚ Europe/Paris â”‚ Albert            â”‚
â•°â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
```
