<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.23">
<meta name="author" content="(c) Copyright 2024, All Rights Reserved">
<title>Couchbase Shell Documentation</title>
<link rel="stylesheet" href="./couchbase.css">
<link rel="stylesheet" href="./coderay-asciidoctor.css">
</head>
<body class="article toc2 toc-left">
<div id="header">
<h1>Couchbase Shell Documentation</h1>
<div class="details">
<span id="author" class="author">(c) Copyright 2024, All Rights Reserved</span><br>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_quickstart">1. Quickstart</a>
<ul class="sectlevel2">
<li><a href="#_installation">1.1. Installation</a>
<ul class="sectlevel3">
<li><a href="#_binaries">1.1.1. Binaries</a></li>
<li><a href="#_homebrew">1.1.2. Homebrew</a></li>
</ul>
</li>
<li><a href="#_connecting_to_a_cluster">1.2. Connecting to a Cluster</a></li>
<li><a href="#_the_config_dotfiles">1.3. The config dotfiles</a></li>
</ul>
</li>
<li><a href="#_introduction">2. Introduction</a>
<ul class="sectlevel2">
<li><a href="#_navigating_the_shell">2.1. Navigating the Shell</a></li>
<li><a href="#_getting_help">2.2. Getting Help</a></li>
<li><a href="#_the_prompt_explained">2.3. The Prompt explained</a></li>
<li><a href="#_loading_data_into_the_shell">2.4. Loading Data into the Shell</a>
<ul class="sectlevel3">
<li><a href="#_manual_import">2.4.1. Manual import</a></li>
</ul>
</li>
<li><a href="#_exporting_data_from_the_shell">2.5. Exporting Data from the Shell</a></li>
</ul>
</li>
<li><a href="#_cb_env_and_the_environment">3. <code>cb-env</code> and the Environment</a>
<ul class="sectlevel2">
<li><a href="#_cb_env_managed">3.1. <code>cb-env managed</code></a></li>
<li><a href="#_cb_env_cluster">3.2. <code>cb-env cluster</code></a></li>
<li><a href="#_cb_env_bucketscopecollection">3.3. <code>cb-env bucket/scope/collection</code></a></li>
<li><a href="#_cb_env_projectcapella_organization">3.4. <code>cb-env project/capella-organization</code></a></li>
<li><a href="#_cb_env_register">3.5. <code>cb-env register</code></a></li>
<li><a href="#_cb_env_llm">3.6. <code>cb-env llm</code></a></li>
<li><a href="#_per_command_execution_environments">3.7. Per command execution environments</a>
<ul class="sectlevel3">
<li><a href="#_the_clusters_flag">3.7.1. The <code>--clusters</code> flag</a></li>
<li><a href="#_the_bucket_scope_collection_flags">3.7.2. The <code>--bucket</code>, <code>--scope</code>, <code>--collection</code> flags</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_couchbase_commands">4. Couchbase Commands</a>
<ul class="sectlevel2">
<li><a href="#_buckets">4.1. buckets</a>
<ul class="sectlevel3">
<li><a href="#_buckets_2">4.1.1. <code>buckets</code></a></li>
<li><a href="#_buckets_config">4.1.2. <code>buckets config</code></a></li>
<li><a href="#_buckets_create">4.1.3. <code>buckets create</code></a></li>
<li><a href="#_buckets_drop">4.1.4. <code>buckets drop</code></a></li>
<li><a href="#_buckets_flush">4.1.5. <code>buckets flush</code></a></li>
<li><a href="#_buckets_get">4.1.6. <code>buckets get</code></a></li>
<li><a href="#_buckets_load_sample">4.1.7. <code>buckets load-sample</code></a></li>
<li><a href="#_buckets_update">4.1.8. <code>buckets update</code></a></li>
</ul>
</li>
<li><a href="#_scopes">4.2. scopes</a>
<ul class="sectlevel3">
<li><a href="#_scopes_2">4.2.1. <code>scopes</code></a></li>
<li><a href="#_scopes_create">4.2.2. <code>scopes create</code></a></li>
<li><a href="#_scopes_drop">4.2.3. <code>scopes drop</code></a></li>
</ul>
</li>
<li><a href="#_collections">4.3. collections</a>
<ul class="sectlevel3">
<li><a href="#_collections_2">4.3.1. <code>collections</code></a></li>
<li><a href="#_collections_create">4.3.2. <code>collections create</code></a></li>
<li><a href="#_collections_drop">4.3.3. <code>collections drop</code></a></li>
</ul>
</li>
<li><a href="#_doc">4.4. doc</a>
<ul class="sectlevel3">
<li><a href="#_doc_get">4.4.1. <code>doc get</code></a></li>
<li><a href="#_doc_import">4.4.2. <code>doc import</code></a></li>
<li><a href="#_doc_insert">4.4.3. <code>doc insert</code></a></li>
<li><a href="#_doc_remove">4.4.4. <code>doc remove</code></a></li>
<li><a href="#_doc_replace">4.4.5. <code>doc replace</code></a></li>
<li><a href="#_doc_upsert">4.4.6. <code>doc upsert</code></a></li>
</ul>
</li>
<li><a href="#_nodes">4.5. <code>nodes</code></a></li>
<li><a href="#_subdoc_get">4.6. <code>subdoc get</code></a></li>
<li><a href="#_query">4.7. query</a>
<ul class="sectlevel3">
<li><a href="#_query_2">4.7.1. <code>query</code></a></li>
<li><a href="#_query_advise">4.7.2. <code>query advise</code></a></li>
<li><a href="#_query_indexes">4.7.3. <code>query indexes</code></a></li>
</ul>
</li>
<li><a href="#_vector">4.8. vector</a>
<ul class="sectlevel3">
<li><a href="#_vector_search">4.8.1. <code>vector search</code></a></li>
<li><a href="#_vector_create_index">4.8.2. <code>vector create-index</code></a></li>
<li><a href="#_vector_enrich_doc">4.8.3. <code>vector enrich-doc</code></a></li>
<li><a href="#_vector_enrich_text">4.8.4. <code>vector enrich-text</code></a></li>
</ul>
</li>
<li><a href="#_ask">4.9. <code>ask</code></a></li>
<li><a href="#_version">4.10. <code>version</code></a></li>
</ul>
</li>
<li><a href="#_reference">5. Reference</a>
<ul class="sectlevel2">
<li><a href="#_config_file_format">5.1. Config File Format</a></li>
<li><a href="#_credentials_file_format">5.2. Credentials File Format</a></li>
<li><a href="#_importing_data">5.3. Importing data</a>
<ul class="sectlevel3">
<li><a href="#_from_file">5.3.1. From file</a>
<ul class="sectlevel4">
<li><a href="#_from_json">From JSON</a></li>
<li><a href="#_from_csv">From CSV</a></li>
</ul>
</li>
<li><a href="#_modifying_data">5.3.2. Modifying data</a></li>
</ul>
</li>
<li><a href="#_exporting_data">5.4. Exporting data</a>
<ul class="sectlevel3">
<li><a href="#_a_note_on_data_format">5.4.1. A Note On Data format</a></li>
<li><a href="#_to_file">5.4.2. To file</a>
<ul class="sectlevel4">
<li><a href="#_to_json">To JSON</a></li>
<li><a href="#_to_csv">To CSV</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#_release_notes">6. Release Notes</a>
<ul class="sectlevel2">
<li><a href="#_1_0_0_2024_09_11">6.1. 1.0.0 - 2024-09-11</a></li>
<li><a href="#_0_75_2_2023_04_10">6.2. 0.75.2 - 2023-04-10</a></li>
<li><a href="#_0_75_1_2023_04_13">6.3. 0.75.1 - 2023-04-13</a></li>
<li><a href="#_0_75_0_2023_02_09">6.4. 0.75.0 - 2023-02-09</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
<script>
$(document).ready(function () {
    // Handler for .ready() called.
    var hash = $(location).attr('hash');
    $('html, body').animate({
        scrollTop: $(hash).offset().top - 64
    }, 'slow');
});
</script>
<div class="paragraph">
<p>Welcome to the Couchbase Shell <code>cbsh</code> documentation!
If you are new, you will want to start with the <a href="#_quickstart">quickstart</a> section and then proceed with the <a href="#_introduction">introduction</a>.
If you are already familiar with the shell, feel free to jump right into the <a href="#_couchbase_commands">couchbase commands</a>.</p>
</div>
<div class="paragraph">
<p><em>Note that while the project is maintained by Couchbase, it is not covered under the EE support contract.
We are providing community support through this <a href="https://github.com/couchbaselabs/couchbase-shell/issues">bug tracker</a>.</em></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_quickstart">1. Quickstart</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_installation">1.1. Installation</h3>
<div class="paragraph">
<p>The current latest version is <strong>1.0.0</strong>.</p>
</div>
<div class="paragraph">
<p>There are a couple ways you can get access to <code>cbsh</code>.</p>
</div>
<div class="sect3">
<h4 id="_binaries">1.1.1. Binaries</h4>
<div class="paragraph">
<p>Download our pre-built binaries for your platform of choice:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Linux: <a href="https://github.com/couchbaselabs/couchbase-shell/releases/download/v1.0.0/cbsh-x86_64-unknown-linux-gnu.tar.gz">cbsh-x86_64-unknown-linux-gnu.tar.gz</a></p>
</li>
<li>
<p>macOS: <a href="https://github.com/couchbaselabs/couchbase-shell/releases/download/v1.0.0/cbsh-x86_64-apple-darwin.zip">cbsh-x86_64-apple-darwin.zip</a></p>
</li>
<li>
<p>Linux aarch64: <a href="https://github.com/couchbaselabs/couchbase-shell/releases/download/v1.0.0/cbsh-aarch64-unknown-linux-gnu.tar.gz">cbsh-aarch64-unknown-linux-gnu.tar.gz</a></p>
</li>
<li>
<p>macOS aarch64: <a href="https://github.com/couchbaselabs/couchbase-shell/releases/download/v1.0.0/cbsh-aarch64-apple-darwin.zip">cbsh-aarch64-apple-darwin.zip</a></p>
</li>
<li>
<p>Windows: <a href="https://github.com/couchbaselabs/couchbase-shell/releases/download/v1.0.0/cbsh-x86_64-pc-windows-msvc.zip">cbsh-x86_64-pc-windows-msvc.zip</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Once you&#8217;ve downloaded the <code>zip</code> file, extract it and switch into the just created directory.
The following example shows it for mac, but it works very similar if you are on linux (just align the commands with the file you just downloaded):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>$ unzip cbsh-x86_64-apple-darwin.zip
$ ls
cbsh LICENSE LICENSE_AGREEMENT  README.md</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can now run the <code>cbsh</code> binary:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>â¯ ./cbsh --version
The Couchbase Shell 1.0.0</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
If you are running a recent macOS release (i.e. 10.15.x), you&#8217;ll likely see an error similar to <strong>"cbsh" was blocked from use because it is not from an identified developer</strong>.
This is because our binaries are not yet signed.
To run it nonetheless you need to either navigate to <code>System Preferences &#8594; Security &amp; Privacy</code> and click <code>Allow Anyway</code>, or  run <code>sudo xattr -r -d com.apple.quarantine $PWD/cbsh</code> inside your terminal.
Next time you run the binary you&#8217;ll get another prompt but then it should run fine.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_homebrew">1.1.2. Homebrew</h4>
<div class="paragraph">
<p>If running on macOS you can install via the <a href="https://formulae.brew.sh/formula/couchbase-shell">Homebrew</a> formula:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>$ brew install couchbase-shell</code></pre>
</div>
</div>
<div class="paragraph">
<p>Then run as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>$ cbsh --version
1.0.0</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_connecting_to_a_cluster">1.2. Connecting to a Cluster</h3>
<div class="paragraph">
<p>The first time that you run <code>./cbsh</code> you will receive a prompt asking if you&#8217;d like to create a <a href="#_the_config_dotfiles">config file</a>.
If you choose yes then the shell will provide you with a series of prompts to provide information about your default cluster.
If you choose no then it will try to connect to <code>localhost</code> using the <code>Administrator</code> username and the <code>password</code> password.</p>
</div>
<div class="paragraph">
<p>You can modify this through CLI arguments (see <code>./cbsh -h</code> for more information).</p>
</div>
<div class="paragraph">
<p>Note: Unless you specify TLS settings then PLAIN authentication is used and your credentials are sent in plaintext.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>â¯ ./cbsh --username Administrator --connstr 127.0.0.1 -p password --disable-tls
No config file found
Would you like to create one now (Y/n)?
n
[WARN] 2024-04-17 09:20:22.466 Using PLAIN authentication for cluster default, credentials will sent in plaintext - configure tls to disable this warning
[INFO] 2024-04-17 09:20:22.677 Thanks for trying CBSH!
ğŸ‘¤ Administrator ğŸ  default
&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Once in the shell, you can start to execute commands (see the introduction section for more information).
As a quick sanity check, list the nodes in the cluster:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>&gt; nodes
â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ # â”‚  cluster  â”‚    hostname    â”‚ status  â”‚         services         â”‚        version        â”‚            os             â”‚ memory_total â”‚ memory_free â”‚ capella â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0 â”‚ dev.local â”‚ 127.0.0.1:8091 â”‚ healthy â”‚ search,indexing,kv,query â”‚ 8.0.0-1246-enterprise â”‚ x86_64-apple-darwin19.6.0 â”‚  34359738368 â”‚ 12026126336 â”‚ false   â”‚
â•°â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯</code></pre>
</div>
</div>
<div class="paragraph">
<p>To start experimenting with data operations load some sample data onto the cluster:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>ğŸ‘¤ Administrator ğŸ  default
&gt; buckets load-sample travel-sample
â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ # â”‚ cluster â”‚    sample     â”‚ status  â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0 â”‚ local   â”‚ travel-sample â”‚ success â”‚
â•°â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now you can try running N1QL queries using the <a href="#_query">query</a> command.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>ğŸ‘¤ Administrator ğŸ  default
&gt; query &quot;SELECT * FROM `travel-sample`.inventory.airline LIMIT 1&quot;
â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ # â”‚           airline            â”‚ cluster â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0 â”‚ â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•® â”‚ local   â”‚
â”‚   â”‚ â”‚ id       â”‚ 10            â”‚ â”‚         â”‚
â”‚   â”‚ â”‚ type     â”‚ airline       â”‚ â”‚         â”‚
â”‚   â”‚ â”‚ name     â”‚ 40-Mile Air   â”‚ â”‚         â”‚
â”‚   â”‚ â”‚ iata     â”‚ Q5            â”‚ â”‚         â”‚
â”‚   â”‚ â”‚ icao     â”‚ MLA           â”‚ â”‚         â”‚
â”‚   â”‚ â”‚ callsign â”‚ MILE-AIR      â”‚ â”‚         â”‚
â”‚   â”‚ â”‚ country  â”‚ United States â”‚ â”‚         â”‚
â”‚   â”‚ â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯ â”‚         â”‚
â•°â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯</code></pre>
</div>
</div>
<div class="paragraph">
<p>Or you can get documents by switching to the travel sample bucket with <a href="#_cb_env_and_the_environment">cb-env</a> and using <a href="https://couchbase.sh/docs/#_doc_get">doc get</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>ğŸ‘¤ Administrator ğŸ  default
&gt; cb-env bucket travel-sample
ğŸ‘¤ Administrator ğŸ  default in ğŸ—„ travel-sample._default._default
&gt; doc get airline_10
â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ # â”‚     id     â”‚           content            â”‚         cas         â”‚ error â”‚ cluster â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0 â”‚ airline_10 â”‚ â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•® â”‚ 1722587332136927232 â”‚       â”‚ local   â”‚
â”‚   â”‚            â”‚ â”‚ id       â”‚ 10            â”‚ â”‚                     â”‚       â”‚         â”‚
â”‚   â”‚            â”‚ â”‚ type     â”‚ airline       â”‚ â”‚                     â”‚       â”‚         â”‚
â”‚   â”‚            â”‚ â”‚ name     â”‚ 40-Mile Air   â”‚ â”‚                     â”‚       â”‚         â”‚
â”‚   â”‚            â”‚ â”‚ iata     â”‚ Q5            â”‚ â”‚                     â”‚       â”‚         â”‚
â”‚   â”‚            â”‚ â”‚ icao     â”‚ MLA           â”‚ â”‚                     â”‚       â”‚         â”‚
â”‚   â”‚            â”‚ â”‚ callsign â”‚ MILE-AIR      â”‚ â”‚                     â”‚       â”‚         â”‚
â”‚   â”‚            â”‚ â”‚ country  â”‚ United States â”‚ â”‚                     â”‚       â”‚         â”‚
â”‚   â”‚            â”‚ â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯ â”‚                     â”‚       â”‚         â”‚
â•°â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_the_config_dotfiles">1.3. The config dotfiles</h3>
<div class="paragraph">
<p>Connecting to a single cluster through the command line is nice when you are starting out, but later on you will likely either connect to the same cluster all the time or even to a multitude of them.
To help with this, you can create a config file to hold your cluster details that the shell will read on startup.</p>
</div>
<div class="paragraph">
<p>The config file must be called <code>config</code> and be placed in a <code>.cbsh</code> dot file either in your home directory or in the directory from which the shell is being run.
If you want to change the path of the directory where the config file is held this can be done with the <code>config-dir</code> flag when the shell is run:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>&gt; ls ~/config_file
config
&gt; ./cbsh --config-dir ~/config_file</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that even when the path to the directory containing the config file is given using this flag, the file containing the cluster information must still be called <code>config</code>.</p>
</div>
<div class="paragraph">
<p>The downloaded zip contains an example already, but here is a small sample config to help you get started as well:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>version = 1

[[cluster]]
identifier = &quot;local&quot;
connstr = &quot;127.0.0.1&quot;
default-bucket = &quot;travel-sample&quot;
username = &quot;Administrator&quot;
password = &quot;password&quot;

[[cluster]]
identifier = &quot;remote&quot;
connstr = &quot;10.143.200.101&quot;
default-bucket = &quot;myapp&quot;
username = &quot;user&quot;
password = &quot;pass&quot;
capella-organization = &quot;my-org&quot;

[[capella-organization]]
identifier = &quot;my-org&quot;
access-key = &quot;get-your-own&quot;
secret-key = &quot;get-your-own&quot;
default-project = &quot;default&quot;</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will register two clusters, one called <code>local</code> and one called <code>remote</code>.
Now when you start the shell, it will connect to <code>local</code> automatically and you are all set.
Changing between registered clusters is done using <a href="#_cb_env_cluster">cb-env cluster</a>.</p>
</div>
<div class="paragraph">
<p>The config also registers a Capella organization which is associated with the cluster "remote" using the "capella-organization" field, see <a href="#_cb_env_projectcapella_organization">cb-env organizations</a> for more details.
A config file can be created with just a capella-organization then the shell can be used to <a href="#link_to_recipe">create and register </a> a cluster for use.</p>
</div>
<div class="paragraph">
<p>Please check out the <a href="#_reference">reference section</a> on additional parameters you can set as well as how to move the credentials to a separate <code>credentials</code> file in case you want to share your config with other people and they do not use the same credentials.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_introduction">2. Introduction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Couchbase Shell is fully featured, so it does not only contain commands related to Couchbase but is actually built on top of a
general purpose shell called <a href="https://www.nushell.sh/">Nushell</a>. This allows you to interact with the file system or any other
command available on your machine, making it a great tool for both operational and development tasks on top of Couchbase.</p>
</div>
<div class="paragraph">
<p>The following introduction only touches on the basic concepts to make you productive quickly. We recommend also checking out the
great <a href="https://www.nushell.sh/book">Nushell documentation</a> so you can get the most out of it.</p>
</div>
<div class="sect2">
<h3 id="_navigating_the_shell">2.1. Navigating the Shell</h3>
<div class="paragraph">
<p>Commands take inputs and produce output in a structured manner, most often represented as tables. Note how both the generic <code>ls</code>
command and the Couchbase-specific <code>buckets</code> command both produce a table as their output:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>&gt; ls
â•­â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚  # â”‚        name         â”‚ type â”‚   size    â”‚   modified    â”‚
â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  0 â”‚ CHANGELOG.md        â”‚ file â”‚   8.7 KiB â”‚ 2 months ago  â”‚
â”‚  1 â”‚ Cargo.lock          â”‚ file â”‚ 194.6 KiB â”‚ a day ago     â”‚
â”‚  2 â”‚ Cargo.toml          â”‚ file â”‚   2.7 KiB â”‚ a day ago     â”‚
â”‚  3 â”‚ Dockerfile          â”‚ file â”‚     590 B â”‚ 2 months ago  â”‚
â”‚  4 â”‚ LICENSE             â”‚ file â”‚  11.1 KiB â”‚ 2 months ago  â”‚
â”‚  5 â”‚ LICENSE_AGREEMENT   â”‚ file â”‚  43.7 KiB â”‚ 2 months ago  â”‚
â”‚  6 â”‚ NOTICES             â”‚ file â”‚ 221.6 KiB â”‚ a week ago    â”‚
â”‚  7 â”‚ README.md           â”‚ file â”‚   9.4 KiB â”‚ 2 months ago  â”‚
â”‚  8 â”‚ build               â”‚ dir  â”‚      64 B â”‚ 4 weeks ago   â”‚
â”‚  9 â”‚ docs                â”‚ dir  â”‚     608 B â”‚ 3 minutes ago â”‚
â”‚ 10 â”‚ examples            â”‚ dir  â”‚     192 B â”‚ 4 months ago  â”‚
â”‚ 11 â”‚ jupyter             â”‚ dir  â”‚     128 B â”‚ 4 months ago  â”‚
â”‚ 12 â”‚ rust-toolchain.toml â”‚ file â”‚     524 B â”‚ 2 weeks ago   â”‚
â”‚ 13 â”‚ src                 â”‚ dir  â”‚     416 B â”‚ a day ago     â”‚
â”‚ 14 â”‚ target              â”‚ dir  â”‚     352 B â”‚ 2 weeks ago   â”‚
â”‚ 15 â”‚ tests               â”‚ dir  â”‚     160 B â”‚ 4 months ago  â”‚
â•°â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>&gt; buckets
â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ # â”‚ cluster â”‚     name      â”‚   type    â”‚ replicas â”‚ min_durability_level â”‚ ram_quota â”‚ flush_enabled â”‚ status â”‚ cloud â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0 â”‚ default â”‚ beer-sample   â”‚ couchbase â”‚        1 â”‚ none                 â”‚ 200.0 MiB â”‚ false         â”‚        â”‚ false â”‚
â”‚ 1 â”‚ default â”‚ default       â”‚ couchbase â”‚        2 â”‚ none                 â”‚ 100.0 MiB â”‚ true          â”‚        â”‚ false â”‚
â”‚ 2 â”‚ default â”‚ travel-sample â”‚ couchbase â”‚        2 â”‚ none                 â”‚ 200.0 MiB â”‚ false         â”‚        â”‚ false â”‚
â•°â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â•¯</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can pipe the output into other commands, for example if you only want to see buckets that have <code>sample</code> in their name you
can utilize the <code>where</code> command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>&gt; buckets | where name =~ &quot;sample&quot;
â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ # â”‚ cluster â”‚     name      â”‚   type    â”‚ replicas â”‚ min_durability_level â”‚ ram_quota â”‚ flush_enabled â”‚ status â”‚ cloud â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0 â”‚ default â”‚ beer-sample   â”‚ couchbase â”‚        1 â”‚ none                 â”‚ 200.0 MiB â”‚ false         â”‚        â”‚ false â”‚
â”‚ 1 â”‚ default â”‚ travel-sample â”‚ couchbase â”‚        2 â”‚ none                 â”‚ 200.0 MiB â”‚ false         â”‚        â”‚ false â”‚
â•°â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â•¯</code></pre>
</div>
</div>
<div class="paragraph">
<p>In a similar fashion you can turn this structured table into other output formats, for example JSON:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>&gt; buckets | where name =~ &quot;sample&quot; | to json
[
  {
    &quot;cluster&quot;: &quot;default&quot;,
    &quot;name&quot;: &quot;beer-sample&quot;,
    &quot;type&quot;: &quot;couchbase&quot;,
    &quot;replicas&quot;: 1,
    &quot;min_durability_level&quot;: &quot;none&quot;,
    &quot;ram_quota&quot;: 209715200,
    &quot;flush_enabled&quot;: false,
    &quot;status&quot;: &quot;&quot;,
    &quot;cloud&quot;: false
  },
  {
    &quot;cluster&quot;: &quot;default&quot;,
    &quot;name&quot;: &quot;travel-sample&quot;,
    &quot;type&quot;: &quot;couchbase&quot;,
    &quot;replicas&quot;: 2,
    &quot;min_durability_level&quot;: &quot;none&quot;,
    &quot;ram_quota&quot;: 209715200,
    &quot;flush_enabled&quot;: false,
    &quot;status&quot;: &quot;&quot;,
    &quot;cloud&quot;: false
  }
]</code></pre>
</div>
</div>
<div class="paragraph">
<p>Exactly this type of composition takes the unix philosophy of "do one thing well" and meshes it together with the idea of flexible
structured pipelines. This allows to build powerful compositions that help you in your daily operations with Couchbase, both from
a developer or operations point of view.</p>
</div>
</div>
<div class="sect2">
<h3 id="_getting_help">2.2. Getting Help</h3>
<div class="paragraph">
<p>Other than using this documentation for help, each command can be called with <code>-h</code> or <code>--help</code> to get information about potential
flags, arguments and subcommands. Also, some commands provide additional examples.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>&gt; buckets -h
Perform bucket management operations

Usage:
  &gt; buckets {flags}

Subcommands:
  buckets config - Shows the bucket config (low level)
  buckets create - Creates a bucket
  buckets drop - Drops buckets through the HTTP API
  buckets flush - Flushes buckets through the HTTP API
  buckets get - Fetches buckets through the HTTP API
  buckets load-sample - Load a sample bucket
  buckets update - Updates a bucket

Flags:
  -h, --help - Display the help message for this command
  --clusters &lt;String&gt; - the clusters which should be contacted</code></pre>
</div>
</div>
<div class="paragraph">
<p>Some commands (like the one above) only act as groupings for subcommands, like <code>from</code>, <code>to</code> or <code>doc</code>. Since they do not serve a
purpose on their own, they will render their help output automatically:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>&gt; doc
Usage:
  &gt; doc

Subcommands:
  doc get - Fetches a document through the data service
  doc import - Import documents from a file through the data service
  doc insert - Insert a document through the data service
  doc remove - Removes a document through the data service
  doc replace - Replace a document through the data service
  doc upsert - Upsert (insert or override) a document through the data service

Flags:
  -h, --help - Display the help message for this command</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_the_prompt_explained">2.3. The Prompt explained</h3>
<div class="paragraph">
<p>Couchbase Shell uses a custom, two line prompt to show you exactly in what environment you are working in right now. Since you
can connect to different clusters, switch buckets etc. it is important to know what is currently "active", as the active buckets/scope/collection
will be what commands are run against. Here is a sample prompt that will greet you when starting the shell:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>ğŸ‘¤ Administrator ğŸ  local in ğŸ—„ travel-sample._default._default
&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>It tells you that your user is <code>Administrator</code>, the current active cluster identifier is <code>local</code> and the active bucket is <code>travel-sample</code>.
The current scope and collection have not been set, so they assume the <code>_default</code> value.</p>
</div>
<div class="paragraph">
<p>If you have an active scope or collection set then the prompt will also update to reflect that:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>ğŸ‘¤ Administrator ğŸ  local in ğŸ—„ travel-sample.inventory.landmark
&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>If we ran a <code>doc get</code> it would fetch the doc from travel-sample.inventory.landmark. In the second line, your actual user prompt starts.</p>
</div>
</div>
<div class="sect2">
<h3 id="_loading_data_into_the_shell">2.4. Loading Data into the Shell</h3>
<div class="paragraph">
<p>If you want to import data into Couchbase, or just load it into the shell for further processing, there are different commands available to help you.
Once data is loaded into the shell the simplest way to save it to the connected cluster is using the <a href="#_doc_import">doc import</a> command.
Alternatively if you want more control over the format and key of the uploaded data you can upload it manually using one of the other Couchbase save commands: <code>doc upsert</code> and <code>doc insert</code>.</p>
</div>
<div class="sect3">
<h4 id="_manual_import">2.4.1. Manual import</h4>
<div class="paragraph">
<p>The <code>open</code> command will look at file endings and try to decode it automatically.
Imagine a file named <code>user.json</code> in your current directory.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>&gt; cat user.json
{
  &quot;name&quot;: &quot;Michael&quot;,
  &quot;age&quot;: 32,
  &quot;height&quot;: 180
}

&gt; open user.json
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ name   â”‚ Michael â”‚
â”‚ age    â”‚ 32      â”‚
â”‚ height â”‚ 180     â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯</code></pre>
</div>
</div>
<div class="paragraph">
<p>As you can see, the <code>open</code> command automatically decoded the JSON document into the tabular format.
If the filename would only be <code>user</code>, the import would look like this instead:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>&gt; open user
{
  &quot;name&quot;: &quot;Michael&quot;,
  &quot;age&quot;: 32,
  &quot;height&quot;: 180
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you are dealing with data that cannot be decoded automatically, you can use the various <code>from</code> subcommands to help with decoding.
In our case we use <code>from json</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>&gt; open user | from json
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ name   â”‚ Michael â”‚
â”‚ age    â”‚ 32      â”‚
â”‚ height â”‚ 180     â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>doc upsert</code> and <code>doc insert</code> commands require there to be only two fields/columns.
By default, these two columns are named <code>id</code> and <code>content</code>, but these can be overridden with <code>--id-column</code> and <code>--content-column</code>.
The id column will be used as the key for the document, while the content column will be the json stored using that key.
To get <code>user.json</code> in a format that can be inserted into the connected Cluster we <a href="https://www.nushell.sh/commands/docs/wrap.html">wrap</a> the entire document into a content column and then <a href="https://www.nushell.sh/commands/docs/insert.html">insert</a> the id that we want to use:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>&gt; open user.json | wrap content | insert id $in.content.name
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚         â”‚ â•­â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â•® â”‚
â”‚ content â”‚ â”‚ name   â”‚ Michael â”‚ â”‚
â”‚         â”‚ â”‚ age    â”‚ 32      â”‚ â”‚
â”‚         â”‚ â”‚ height â”‚ 180     â”‚ â”‚
â”‚         â”‚ â•°â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯ â”‚
â”‚ id      â”‚ Michael              â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯</code></pre>
</div>
</div>
<div class="paragraph">
<p>There are many other approaches to achieving this same result.
With our data in the correct format we can then upsert:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>&gt; open user.json | wrap content | insert id $in.content.name | doc upsert
â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ # â”‚ processed â”‚ success â”‚ failed â”‚ failures â”‚  cluster  â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0 â”‚         1 â”‚       1 â”‚      0 â”‚          â”‚ local     â”‚
â•°â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯</code></pre>
</div>
</div>
<div class="paragraph">
<p>See the <a href="#_importing_data">Importing data recipes</a> for more examples.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_exporting_data_from_the_shell">2.5. Exporting Data from the Shell</h3>
<div class="paragraph">
<p>The export counterparts to <code>open</code> and <code>from</code>, are <code>save</code> and <code>to</code>.
You can use both commands to take tabular data from the shell and store it in files of the needed target format.</p>
</div>
<div class="paragraph">
<p>Like <code>open</code>, <code>save</code> will try to discern the format from the file ending.
The following example will load a JSON file and then save it as CSV:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>&gt; cat user.json
{
  &quot;name&quot;: &quot;Michael&quot;,
  &quot;age&quot;: 32,
  &quot;height&quot;: 180
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>&gt; open user.json | save user.csv</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>&gt; cat user.csv
name,age,height
Michael,32,180</code></pre>
</div>
</div>
<div class="paragraph">
<p>This example is dealing with only one row for simplicity, but you can save as many rows as you need in one file.</p>
</div>
<div class="paragraph">
<p>As a motivating example, the following snippet runs a N1QL query and stores the result as a csv file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>&gt; query &quot;select airportname,city,country from `travel-sample` where type = 'airport' limit 10&quot; | save output.csv</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>&gt; cat output.csv
airportname,city,country
Calais Dunkerque,Calais,France
Peronne St Quentin,Peronne,France
Les Loges,Nangis,France
Couterne,Bagnole-de-l'orne,France
Bray,Albert,France
Le Touquet Paris Plage,Le Tourquet,France
Denain,Valenciennes,France
Glisy,Amiens,France
La Garenne,Agen,France
Cazaux,Cazaux,France</code></pre>
</div>
</div>
<div class="paragraph">
<p>See the <a href="#_exporting_data">Exporting data recipes</a> for more information.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_cb_env_and_the_environment">3. <code>cb-env</code> and the Environment</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Whilst multiple clusters can be registered at the same time, there is only ever one cluster (at most) active.
The same is true for buckets, scopes, and collections.
When a resource is active it is used as the default to run commands against (this can be overridden on a <a href="#_per_command_execution_environments">per command</a> basis).</p>
</div>
<div class="paragraph">
<p>The <code>cb-env</code> command will tell you which resources are currently active (you are also able to tell from the <a href="#_the_prompt_explained">prompt</a>):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>&gt; cb-env
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ username             â”‚ charlie      â”‚
â”‚ display_name         â”‚ Charlie      â”‚
â”‚ cluster              â”‚ capella      â”‚
â”‚ bucket               â”‚ default      â”‚
â”‚ scope                â”‚ inventory    â”‚
â”‚ collection           â”‚ hotel        â”‚
â”‚ cluster_type         â”‚ provisioned  â”‚
â”‚ capella-organization â”‚ couchbase    â”‚
â”‚ capella-project      â”‚ Charlie work â”‚
â”‚ llm                  â”‚ Gemini       â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you were to now run a command then we would be running it:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>As the user "charlie"</p>
</li>
<li>
<p>Against the "capella" cluster</p>
</li>
<li>
<p>Against the "default" bucket</p>
</li>
<li>
<p>Against the "inventory" scope</p>
</li>
<li>
<p>Against the "hotel" collection</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Note that <code>display_name</code> is the name that appears in your shell prompt and is not used by commands.</p>
</div>
<div class="paragraph">
<p>You can also change the active resources with the cb-env command.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>&gt; cb-env -h
Modify the default execution environment of commands

Usage:
  &gt; cb-env {flags}

Subcommands:
  cb-env bucket - Sets the active bucket based on its name
  cb-env capella-organization - Sets the active capella organization based on its identifier
  cb-env cluster - Sets the active cluster based on its identifier
  cb-env collection - Sets the active collection based on its name
  cb-env managed - Lists all clusters currently managed by couchbase shell
  cb-env project - Sets the active project based on its name
  cb-env register - Registers a cluster for use with the shell
  cb-env scope - Sets the active scope based on its name
  cb-env timeouts - Sets the active timeouts for operations
  cb-env unregister - Unregisters a cluster for use with the shell

Flags:
  -h, --help - Display the help message for this command
  --capella - show default execution environment of capella
  --timeouts - show default execution environment for timeouts</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_cb_env_managed">3.1. <code>cb-env managed</code></h3>
<div class="paragraph">
<p>Lists all the clusters you have registered with the shell.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>&gt; cb-env managed
â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ # â”‚ active â”‚  tls  â”‚ identifier â”‚   username    â”‚ capella_organization â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0 â”‚ true   â”‚ false â”‚ dev.local  â”‚ Administrator â”‚                      â”‚
â”‚ 1 â”‚ false  â”‚ true  â”‚ capella    â”‚ charlie       â”‚                      â”‚
â•°â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_cb_env_cluster">3.2. <code>cb-env cluster</code></h3>
<div class="paragraph">
<p>Changes the active cluster.
The change of cluster will be reflected in the output of <code>cb-env</code> and the prompt:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>ğŸ‘¤ Charlie ğŸ  capella
&gt; cb-env cluster local
ğŸ‘¤ Charlie ğŸ  local
&gt; cb-env
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ username     â”‚ charlie       â”‚
â”‚ display_name â”‚ Charlie       â”‚
â”‚ cluster      â”‚ local         â”‚
â”‚ bucket       â”‚               â”‚
â”‚ scope        â”‚               â”‚
â”‚ collection   â”‚               â”‚
â”‚ cluster_type â”‚ other         â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯</code></pre>
</div>
</div>
<div class="paragraph">
<p>Notice that when you are connected to a locally running (non-Capella) cluster then the capella specific fields (project and capella organization) will not appear.</p>
</div>
<div class="paragraph">
<p>When changing the cluster the shell will return an error if a cluster with the given identifier is not registered:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>&gt; cb-env cluster unregistered
Error:   Ã— The cluster named unregistered is not known</code></pre>
</div>
</div>
<div class="paragraph">
<p>To register a new cluster for use either add it to the <a href="#_the_config_dotfiles">config file</a> or use the <a href="#_cb_env_register">cb-env register</a> command.</p>
</div>
</div>
<div class="sect2">
<h3 id="_cb_env_bucketscopecollection">3.3. <code>cb-env bucket/scope/collection</code></h3>
<div class="paragraph">
<p>The <code>cb-env bucket</code>, <code>cb-env scope</code> and <code>cb-env collection</code> commands are used to set the active bucket/scope/collection respectively.
When changing the bucket/scope/collection the change will be reflected in the <a href="#_the_prompt_explained">prompt</a> and the output of the <a href="#_cb_env_and_the_environment">cb-env</a> command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>ğŸ‘¤ Charlie ğŸ  local
&gt; cb-env bucket travel-sample
ğŸ‘¤ Charlie ğŸ  local in ğŸ—„ travel-sample._default._default
&gt; cb-env scope inventory
ğŸ‘¤ Charlie ğŸ  local in ğŸ—„ travel-sample.inventory._default
&gt; cb-env collection landmark
ğŸ‘¤ Charlie ğŸ  local in ğŸ—„ travel-sample.inventory.landmark
&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that when we set an active bucket the scope and collection are set to the <code>_default</code> scope and collection.</p>
</div>
<div class="paragraph">
<p>When a "higher level" entity is changed the "lower level" entities are returned to this default setting:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>ğŸ‘¤ Charlie ğŸ  local in ğŸ—„ travel-sample.inventory.landmarks
&gt; cb-env scope some_scope
ğŸ‘¤ Charlie ğŸ  local in ğŸ—„ travel-sample.some_scope._default
&gt; cb-env bucket some_bucket
ğŸ‘¤ Charlie ğŸ  local in ğŸ—„ some_bucket._default._default
&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Setting the scope resets the collection and setting the bucket will reset both the scope and collection.
It is important to remember that these commands do not validate the existence of resources when the environment is changed.
Setting the active bucket/scope/collection to one that doesn&#8217;t exist will only have an impact when you try and perform operations against it.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>ğŸ‘¤ Charlie ğŸ  local
&gt; cb-env bucket not-a-real-bucket
ğŸ‘¤ Charlie ğŸ  local in ğŸ—„ not-a-real-bucket._default._default
&gt; doc get test_doc
â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ # â”‚ id â”‚ content â”‚ cas â”‚                                    error                                     â”‚ cluster â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0 â”‚    â”‚         â”‚   0 â”‚ Failed to load cluster config: bucket 'not-a-real-bucket' could not be found â”‚ local   â”‚
â•°â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯</code></pre>
</div>
</div>
<div class="paragraph">
<p>Checking that the active environment is correctly set to resources that exist is a good first port of call if things aren&#8217;t working as expected.</p>
</div>
</div>
<div class="sect2">
<h3 id="_cb_env_projectcapella_organization">3.4. <code>cb-env project/capella-organization</code></h3>
<div class="paragraph">
<p>The highest level entity in Capella is the organization. Within this you have projects which in turn contain clusters.
Although you can connect to a Capella cluster without it having an <a href="#_the_config_dotfiles">organization registered</a> an organization is required to perform management operations: creating/destroying projects/clusters/buckets.</p>
</div>
<div class="paragraph">
<p>Once we have a registered organization we can set it as active in two ways. Manually, by using the <code>cb-env capella-organization</code> command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>&gt; cb-env capella-organization my-org</code></pre>
</div>
</div>
<div class="paragraph">
<p>Or if you switch to an active cluster that has a default Capella organization specified on registration then that org will become active.
The logic is similar with the active project which can either be changed manually:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>ğŸ‘¤ Administrator ğŸ  local in ğŸ—„ default._default._default
&gt; cb-env project my-project</code></pre>
</div>
</div>
<div class="paragraph">
<p>Alternatively if the active organization has a default project defined on registration then that default project will become active.
Similarly to changing active clusters, the <code>cb-env capella-organization</code> command will return an error if the named org has not been registered with the shell:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>&gt; cb-env capella-organization not-an-org
Error:   Ã— Organization not registered
  help: Has the organization not-an-org been registered in the config file?</code></pre>
</div>
</div>
<div class="paragraph">
<p>But the same is not true with projects, so if operations are unexpectedly failing against a Capella cluster, make sure your active project is correctly set.</p>
</div>
</div>
<div class="sect2">
<h3 id="_cb_env_register">3.5. <code>cb-env register</code></h3>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>&gt; cb-env register --help
Registers a cluster for use with the shell

Usage:
  &gt; cb-env register {flags} &lt;identifier&gt; &lt;connstr&gt; &lt;username&gt; &lt;password&gt;

Flags:
  -h, --help - Display the help message for this command
  --display_name &lt;String&gt; - the display name to use for the user when this cluster is active
  --default-bucket &lt;String&gt; - the default bucket to use with this cluster
  --default-scope &lt;String&gt; - the default scope to use with this cluster
  --default-collection &lt;String&gt; - the default collection to use with this cluster
  --tls-enabled &lt;String&gt; - whether or not to enable tls, defaults to true
  --tls-cert-path &lt;String&gt; - the path to the certificate to use with tls
  --tls-accept-all-certs &lt;String&gt; - whether or not to accept all certs with tls, defaults to true
  --save - whether or not to add the cluster to the .cbsh config file, defaults to false
  --capella-organization &lt;String&gt; - capella organization that this cluster belongs to

Parameters:
  identifier &lt;string&gt;: the identifier to use for this cluster
  connstr &lt;string&gt;: the connection string to use for this cluster
  username &lt;string&gt;: the username to use for this cluster
  password &lt;string&gt;: the password to use for this cluster</code></pre>
</div>
</div>
<div class="paragraph">
<p>This command registers a new cluster for use with the shell without having to add a <code>cluster</code> entry to the <a href="#_the_config_dotfiles">config file</a> and restart.
Note that clusters created through the shell using <code>clusters create</code> are automatically registered for use.
<code>cb-env register</code> takes the local identifier for the cluster, connection string, username and password as positional parameters:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>ğŸ‘¤ Charlie ğŸ  remote in â˜ï¸ default._default._default
&gt; cb-env register new-cluster cb.lcrhwge7pstmolxx.couchbase.com Administrator password</code></pre>
</div>
</div>
<div class="paragraph">
<p>Once registered the new cluster can be seen in the output of <code>cb-env managed</code>, and can be set as the active cluster using <a href="#_cb_env_cluster">cb-env cluster</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>ğŸ‘¤ Charlie ğŸ  remote in â˜ï¸ default._default._default
&gt; cb-env managed
â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ # â”‚ active â”‚  tls  â”‚ identifier  â”‚   username    â”‚ capella_organization â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0 â”‚ false  â”‚ false â”‚ local       â”‚ Administrator â”‚                      â”‚
â”‚ 1 â”‚ false  â”‚ true  â”‚ new-cluster â”‚ Administrator â”‚                      â”‚
â”‚ 2 â”‚ true   â”‚ true  â”‚ remote      â”‚ charlie       â”‚ my-org               â”‚
â•°â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that by default although tls is enabled the shell will accept all certs. This can be changed with the <code>--tls-accept-all-certs</code> flag.</p>
</div>
</div>
<div class="sect2">
<h3 id="_cb_env_llm">3.6. <code>cb-env llm</code></h3>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>&gt; cb-env llm --help
Sets the active llm based on its identifier

Usage:
  &gt; cb-env llm &lt;identifier&gt;

Flags:
  -h, --help - Display the help message for this command

Parameters:
  identifier &lt;string&gt;: the identifier of the llm</code></pre>
</div>
</div>
<div class="paragraph">
<p>This command sets the active llm (large language model), which will be used by the <a href="#_vector_enrich_doc">vector enrich-doc</a>, <a href="#_vector_enrich_text">vector enrich-text</a> and <a href="#_ask">ask</a> commands.</p>
</div>
<div class="paragraph">
<p>To be set as active the llm must be specified in the config file.
For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>[[llm]]
identifier = &quot;OpenAI-small&quot;
provider = &quot;OpenAI&quot;
embed_model = &quot;text-embedding-3-small&quot;
chat_model = &quot;gpt-3.5-turbo&quot;
api_key = &quot;get-your-own&quot;

[[llm]]
identifier = &quot;Bedrock-titan&quot;
provider = &quot;Bedrock&quot;
embed_model = &quot;amazon.titan-embed-text-v1&quot;
chat_model = &quot;amazon.titan-text-express-v1&quot;

[[llm]]
identifier = &quot;Gemini-pro&quot;
provider = &quot;Gemini&quot;
embed_model = &quot;text-embedding-004&quot;
chat_model = &quot;gemini-1.0-pro&quot;
api_key = &quot;get-your-own&quot;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The currently supported providers are Gemini (Google), Bedrock (AWS) and OpenAI.
Specifying values other than these for the provider will result in an error when starting the shell.
Notice that the Bedrock entry does not have an API key, this is because it requires the user to configure an appropriate role using the <a href="https://docs.aws.amazon.com/cli/v1/userguide/cli-configure-role.html">AWS CLI</a>.</p>
</div>
<div class="paragraph">
<p>The <code>embed-model</code> field is the model that will be used to generate embeddings by the <a href="#_vector_enrich_doc">vector enrich-doc</a> and <a href="#_vector_enrich_text">vector enrich-text</a> commands.
While the <code>chat-model</code> is the model that will be used to answer questions with the <a href="#_ask">ask</a> command.
These models can be any that the provider&#8217;s API supports, and should be provided in the format given in the provider&#8217;s API docs.</p>
</div>
<div class="paragraph">
<p>The api-keys can also be given separately in the <a href="#_credentials_file_format">credentials file</a>, for example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>[[llm]]
identifier = &quot;Gemini-pro&quot;
api_key = &quot;get-your-own&quot;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The identifier must be the same as the entry in the config file for this to work.</p>
</div>
<div class="paragraph">
<p>The active llm can be checked using the <a href="#_cb_env_and_the_environment">cb-env</a> command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>ğŸ‘¤ Charlie ğŸ  remote in â˜ï¸ default._default._default
&gt; cb-env
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ username             â”‚ Administrator â”‚
â”‚ display_name         â”‚ Charlie       â”‚
â”‚ cluster              â”‚ remote        â”‚
â”‚ bucket               â”‚ default       â”‚
â”‚ scope                â”‚ _default      â”‚
â”‚ collection           â”‚ _default      â”‚
â”‚ cluster_type         â”‚ provisioned   â”‚
â”‚ capella-organization â”‚ my-org        â”‚
â”‚ llm                  â”‚ Bedrock-titan â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯</code></pre>
</div>
</div>
<div class="paragraph">
<p>When the active llm is changed using <code>cb-env llm</code> this will be reflected in the output of <code>cb-env</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>&gt; cb-env llm Gemini-pro
ğŸ‘¤ Charlie ğŸ  remote in â˜ï¸ default._default._default
&gt; cb-env
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ username             â”‚ Administratorâ”‚
â”‚ display_name         â”‚ Charlie      â”‚
â”‚ cluster              â”‚ remote       â”‚
â”‚ bucket               â”‚ default      â”‚
â”‚ scope                â”‚ _default     â”‚
â”‚ collection           â”‚ _default     â”‚
â”‚ cluster_type         â”‚ provisioned  â”‚
â”‚ capella-organization â”‚ my-org       â”‚
â”‚ llm                  â”‚ Gemini-pro   â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_per_command_execution_environments">3.7. Per command execution environments</h3>
<div class="paragraph">
<p>On many commands you will notice a set of flags which allow you to override the active execution environment.
Different commands support different flags, depending on the command you can expect to see any of:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>--clusters</code></p>
</li>
<li>
<p><code>--bucket</code></p>
</li>
<li>
<p><code>--scope</code></p>
</li>
<li>
<p><code>--collection</code></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_the_clusters_flag">3.7.1. The <code>--clusters</code> flag</h4>
<div class="paragraph">
<p>The argument for this flag is an identifier combined with a regular expression.
So imagine you have three clusters setup with the following names:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>&gt; cb-env managed | get identifier
â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ 0 â”‚ prod-us-east   â”‚
â”‚ 1 â”‚ prod-us-west   â”‚
â”‚ 2 â”‚ prod-eu-center â”‚
â•°â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you wanted to run a command against all clusters in <code>prod-us</code>, you could use <code>--clusters prod-us.*</code>, e.g.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>&gt; buckets --clusters prod-us.*
â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ # â”‚   cluster    â”‚     name      â”‚   type    â”‚ replicas â”‚ min_durability_level â”‚ ram_quota â”‚ flush_enabled â”‚ status â”‚ cloud â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0 â”‚ prod-us-east â”‚ default       â”‚ couchbase â”‚        1 â”‚ none                 â”‚ 200.0 MiB â”‚ false         â”‚        â”‚ false â”‚
â”‚ 1 â”‚ prod-us-west â”‚ default       â”‚ couchbase â”‚        1 â”‚ none                 â”‚ 200.0 MiB â”‚ false         â”‚        â”‚ false â”‚
â”‚ 2 â”‚ prod-us-west â”‚ travel-sample â”‚ couchbase â”‚        1 â”‚ none                 â”‚ 200.0 MiB â”‚ false         â”‚        â”‚ false â”‚
â•°â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â•¯</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the background this gets passed to a regex engine, so you can go a little crazy with it if needed.</p>
</div>
</div>
<div class="sect3">
<h4 id="_the_bucket_scope_collection_flags">3.7.2. The <code>--bucket</code>, <code>--scope</code>, <code>--collection</code> flags</h4>
<div class="paragraph">
<p>These flags are a little different to the <code>--clusters</code> flag, they are not regular expressions and can only be used to define a single name each.
Unlike <code>--clusters</code> the name provided to these flags does not have to be already known to Couchbase Shell, they can refer to any bucket, scope, and collection that exist within your active cluster or defined cluster(s).
For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>&gt; doc get 1 --bucket travel-sample --scope tenant_agent_00 --collection users
â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ # â”‚ id â”‚                                        content                                        â”‚         cas         â”‚ error â”‚   cluster    â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0 â”‚ 1  â”‚ â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•® â”‚ 1712321628245917696 â”‚       â”‚ prod-us-west â”‚
â”‚   â”‚    â”‚ â”‚ name              â”‚ Rigoberto Bernier                                             â”‚ â”‚                     â”‚       â”‚              â”‚
â”‚   â”‚    â”‚ â”‚                   â”‚ â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•® â”‚ â”‚                     â”‚       â”‚              â”‚
â”‚   â”‚    â”‚ â”‚ addresses         â”‚ â”‚ # â”‚ type â”‚     address      â”‚    city    â”‚    country     â”‚ â”‚ â”‚                     â”‚       â”‚              â”‚
â”‚   â”‚    â”‚ â”‚                   â”‚ â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚ â”‚                     â”‚       â”‚              â”‚
â”‚   â”‚    â”‚ â”‚                   â”‚ â”‚ 0 â”‚ home â”‚ 0622 Adams Mills â”‚ Manchester â”‚ United Kingdom â”‚ â”‚ â”‚                     â”‚       â”‚              â”‚
â”‚   â”‚    â”‚ â”‚                   â”‚ â•°â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯ â”‚ â”‚                     â”‚       â”‚              â”‚
â”‚   â”‚    â”‚ â”‚ driving_licence   â”‚ 5f5f145d-a4db-5630-b7d8-874df29a505d                          â”‚ â”‚                     â”‚       â”‚              â”‚
â”‚   â”‚    â”‚ â”‚ passport          â”‚ a1c4f1ac-a7d7-5b97-88ed-11cafc634896                          â”‚ â”‚                     â”‚       â”‚              â”‚
â”‚   â”‚    â”‚ â”‚ preferred_email   â”‚ rigobertobernier@gadugca.sd                                   â”‚ â”‚                     â”‚       â”‚              â”‚
â”‚   â”‚    â”‚ â”‚ preferred_phone   â”‚ (965) 227-3977                                                â”‚ â”‚                     â”‚       â”‚              â”‚
â”‚   â”‚    â”‚ â”‚ preferred_airline â”‚ inventory.airline.airline_5479                                â”‚ â”‚                     â”‚       â”‚              â”‚
â”‚   â”‚    â”‚ â”‚ preferred_airport â”‚ inventory.airport.airport_478                                 â”‚ â”‚                     â”‚       â”‚              â”‚
â”‚   â”‚    â”‚ â”‚                   â”‚ â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®       â”‚ â”‚                     â”‚       â”‚              â”‚
â”‚   â”‚    â”‚ â”‚ credit_cards      â”‚ â”‚ # â”‚       type       â”‚     number      â”‚ expiration â”‚       â”‚ â”‚                     â”‚       â”‚              â”‚
â”‚   â”‚    â”‚ â”‚                   â”‚ â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤       â”‚ â”‚                     â”‚       â”‚              â”‚
â”‚   â”‚    â”‚ â”‚                   â”‚ â”‚ 0 â”‚ American Express â”‚ 346533746753899 â”‚ 2021-04    â”‚       â”‚ â”‚                     â”‚       â”‚              â”‚
â”‚   â”‚    â”‚ â”‚                   â”‚ â•°â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯       â”‚ â”‚                     â”‚       â”‚              â”‚
â”‚   â”‚    â”‚ â”‚ created           â”‚ 2020-04-12                                                    â”‚ â”‚                     â”‚       â”‚              â”‚
â”‚   â”‚    â”‚ â”‚ updated           â”‚ 2021-02-19                                                    â”‚ â”‚                     â”‚       â”‚              â”‚
â”‚   â”‚    â”‚ â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯ â”‚                     â”‚       â”‚              â”‚
â•°â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_couchbase_commands">4. Couchbase Commands</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The following sections discuss the individual Couchbase specific commands in greater detail. Remember, you can always mix and match
them with built-in other shell commands as well as executable programs from your environment.</p>
</div>
<div class="sect2">
<h3 id="_buckets">4.1. buckets</h3>
<div class="paragraph">
<p>The <code>buckets</code> commands are used to perform bucket management operations.
They can be particularly powerful combined with the <a href="https://couchbase.sh/docs/#_the_clusters_flag">--clusters</a> flag.</p>
</div>
<div class="sect3">
<h4 id="_buckets_2">4.1.1. <code>buckets</code></h4>
<div class="paragraph">
<p>Lists all the buckets from your active cluster:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>ğŸ‘¤ Charlie ğŸ  dev.local
&gt; buckets
â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ # â”‚  cluster  â”‚    name     â”‚   type    â”‚ replicas â”‚ min_durability_level â”‚ ram_quota â”‚ flush_enabled â”‚ status â”‚ cloud â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0 â”‚ dev.local â”‚ beer-sample â”‚ couchbase â”‚        2 â”‚ none                 â”‚ 412.0 MiB â”‚ false         â”‚        â”‚ false â”‚
â”‚ 1 â”‚ dev.local â”‚ default     â”‚ couchbase â”‚        0 â”‚ none                 â”‚ 512.0 MiB â”‚ false         â”‚        â”‚ false â”‚
â”‚ 2 â”‚ dev.local â”‚ memd        â”‚ memcached â”‚        0 â”‚ none                 â”‚ 100.0 MiB â”‚ false         â”‚        â”‚ false â”‚
â•°â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â•¯</code></pre>
</div>
</div>
<div class="paragraph">
<p>Check this <a href="https://couchbase.sh/docs/recipes/#_moving_data_between_clusters">recipe</a> to see how <code>cbsh</code> can be used to copy these buckets to another cluster.</p>
</div>
</div>
<div class="sect3">
<h4 id="_buckets_config">4.1.2. <code>buckets config</code></h4>
<div class="paragraph">
<p>Retrieves the full config for the named bucket:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>&gt; buckets config default
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ authType               â”‚ sasl                                                                                 â”‚
â”‚ autoCompactionSettings â”‚ false                                                                                â”‚
â”‚ basicStats             â”‚ {record 8 fields}                                                                    â”‚
â”‚ bucketCapabilities     â”‚ [list 17 items]                                                                      â”‚
â”‚ bucketCapabilitiesVer  â”‚                                                                                      â”‚
â”‚ bucketType             â”‚ membase                                                                              â”‚
â”‚ collectionsManifestUid â”‚ 21                                                                                   â”‚
â”‚ compressionMode        â”‚ passive                                                                              â”‚
â”‚ conflictResolutionType â”‚ seqno                                                                                â”‚
â”‚ controllers            â”‚ {record 4 fields}                                                                    â”‚
â”‚ ddocs                  â”‚ {record 1 field}                                                                     â”‚
â”‚ durabilityMinLevel     â”‚ none                                                                                 â”‚
â”‚ evictionPolicy         â”‚ valueOnly                                                                            â”‚
â”‚ localRandomKeyUri      â”‚ /pools/default/buckets/default/localRandomKey                                        â”‚
â”‚ maxTTL                 â”‚ 0                                                                                    â”‚
â”‚ name                   â”‚ default                                                                              â”‚
â”‚ nodeLocator            â”‚ vbucket                                                                              â”‚
â”‚ nodes                  â”‚ [table 1 row]                                                                        â”‚
â”‚ numVBuckets            â”‚ 64                                                                                   â”‚
â”‚ pitrEnabled            â”‚ false                                                                                â”‚
â”‚ pitrGranularity        â”‚ 600                                                                                  â”‚
â”‚ pitrMaxHistoryAge      â”‚ 86400                                                                                â”‚
â”‚ quota                  â”‚ {record 2 fields}                                                                    â”‚
â”‚ replicaIndex           â”‚ false                                                                                â”‚
â”‚ replicaNumber          â”‚ 0                                                                                    â”‚
â”‚ stats                  â”‚ {record 3 fields}                                                                    â”‚
â”‚ storageBackend         â”‚ couchstore                                                                           â”‚
â”‚ streamingUri           â”‚ /pools/default/bucketsStreaming/default?bucket_uuid=0ef162c33e14b163630f04639b347937 â”‚
â”‚ threadsNumber          â”‚ 3                                                                                    â”‚
â”‚ uri                    â”‚ /pools/default/buckets/default?bucket_uuid=0ef162c33e14b163630f04639b347937          â”‚
â”‚ uuid                   â”‚ 0ef162c33e14b163630f04639b347937                                                     â”‚
â”‚ vBucketServerMap       â”‚ {record 4 fields}                                                                    â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you are unsure what you would use this for, you probably don&#8217;t need it.</p>
</div>
</div>
<div class="sect3">
<h4 id="_buckets_create">4.1.3. <code>buckets create</code></h4>
<div class="paragraph">
<p>Creates a bucket with the specified RAM quota on the active cluster:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>ğŸ‘¤ Charlie ğŸ  local
&gt; buckets create default 256
ğŸ‘¤ Charlie ğŸ  local
&gt; buckets
â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ # â”‚ cluster â”‚  name   â”‚   type    â”‚ replicas â”‚ min_durability_level â”‚ ram_quota â”‚ flush_enabled â”‚ cloud â”‚ max_expiry â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0 â”‚ local   â”‚ default â”‚ couchbase â”‚        1 â”‚ none                 â”‚ 256.0 MiB â”‚ false         â”‚ false â”‚          0 â”‚
â•°â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯</code></pre>
</div>
</div>
<div class="paragraph">
<p>Check this <a href="https://couchbase.sh/docs/recipes.html#_managing_multiple_clusters">recipe</a> to see how <code>cbsh</code> can help find a cluster for your bucket.</p>
</div>
</div>
<div class="sect3">
<h4 id="_buckets_drop">4.1.4. <code>buckets drop</code></h4>
<div class="paragraph">
<p>Drops the named bucket:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>ğŸ‘¤ Charlie ğŸ  local
&gt; buckets
â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ # â”‚ cluster â”‚  name   â”‚   type    â”‚ replicas â”‚ min_durability_level â”‚ ram_quota â”‚ flush_enabled â”‚ cloud â”‚ max_expiry â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0 â”‚ local   â”‚ default â”‚ couchbase â”‚        1 â”‚ none                 â”‚ 256.0 MiB â”‚ false         â”‚ false â”‚          0 â”‚
â•°â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
ğŸ‘¤ Charlie ğŸ  local
&gt; buckets drop default
ğŸ‘¤ Charlie ğŸ  local
&gt; buckets
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ empty list â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_buckets_flush">4.1.5. <code>buckets flush</code></h4>
<div class="paragraph">
<p>Deletes all docs from the named buckets:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>ğŸ‘¤ Charlie ğŸ  local
&gt; query &quot;SELECT * FROM `travel-sample`&quot; | length
31591
ğŸ‘¤ Charlie ğŸ  local
&gt; buckets flush travel-sample
ğŸ‘¤ Charlie ğŸ  local
&gt; query &quot;SELECT * FROM `travel-sample`&quot; | length
0</code></pre>
</div>
</div>
<div class="paragraph">
<p>Not following what&#8217;s going on, check the <a href="https://couchbase.sh/docs/#_query">query</a> and <a href="https://www.nushell.sh/commands/docs/length.html">length</a> documentation.</p>
</div>
</div>
<div class="sect3">
<h4 id="_buckets_get">4.1.6. <code>buckets get</code></h4>
<div class="paragraph">
<p>Gets the named bucket:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>&gt; buckets get travel-sample
â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ # â”‚ cluster â”‚     name      â”‚   type    â”‚ replicas â”‚ min_durability_level â”‚ ram_quota â”‚ flush_enabled â”‚ cloud â”‚ max_expiry â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0 â”‚ local   â”‚ travel-sample â”‚ couchbase â”‚        1 â”‚ none                 â”‚ 200.0 MiB â”‚ true          â”‚ false â”‚          0 â”‚
â•°â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_buckets_load_sample">4.1.7. <code>buckets load-sample</code></h4>
<div class="paragraph">
<p>Loads the named <a href="https://docs.couchbase.com/server/current/manage/manage-settings/install-sample-buckets.html">sample bucket</a> onto the active cluster:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>ğŸ‘¤ Charlie ğŸ  local
&gt; buckets load-sample travel-sample
â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ # â”‚ cluster â”‚    sample     â”‚ status  â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0 â”‚ local   â”‚ travel-sample â”‚ success â”‚
â•°â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
ğŸ‘¤ Charlie ğŸ  local
&gt; buckets
â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ # â”‚ cluster â”‚     name      â”‚   type    â”‚ replicas â”‚ min_durability_level â”‚ ram_quota â”‚ flush_enabled â”‚ cloud â”‚ max_expiry â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0 â”‚ local   â”‚ travel-sample â”‚ couchbase â”‚        1 â”‚ none                 â”‚ 200.0 MiB â”‚ false         â”‚ false â”‚          0 â”‚
â•°â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_buckets_update">4.1.8. <code>buckets update</code></h4>
<div class="paragraph">
<p>Updates the settings of an existing bucket:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>ğŸ‘¤ Charlie ğŸ  local
&gt; buckets
â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ # â”‚ cluster â”‚     name      â”‚   type    â”‚ replicas â”‚ min_durability_level â”‚ ram_quota â”‚ flush_enabled â”‚ cloud â”‚ max_expiry â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0 â”‚ local   â”‚ travel-sample â”‚ couchbase â”‚        1 â”‚ none                 â”‚ 200.0 MiB â”‚ false         â”‚ false â”‚          0 â”‚
â•°â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
ğŸ‘¤ Charlie ğŸ  local
&gt; buckets update travel-sample --flush true --replicas 2 --expiry 100
ğŸ‘¤ Charlie ğŸ  local
&gt; buckets
â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ # â”‚ cluster â”‚     name      â”‚   type    â”‚ replicas â”‚ min_durability_level â”‚ ram_quota â”‚ flush_enabled â”‚ cloud â”‚ max_expiry â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0 â”‚ local   â”‚ travel-sample â”‚ couchbase â”‚        2 â”‚ none                 â”‚ 200.0 MiB â”‚ true          â”‚ false â”‚        100 â”‚
â•°â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_scopes">4.2. scopes</h3>
<div class="paragraph">
<p>The <code>scopes</code> commands are used to manage scopes.</p>
</div>
<div class="sect3">
<h4 id="_scopes_2">4.2.1. <code>scopes</code></h4>
<div class="paragraph">
<p>Lists all of the scopes in the active bucket:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>ğŸ‘¤ Charlie ğŸ  local in ğŸ—„ travel-sample._default._default
&gt; scopes
â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ # â”‚      scope      â”‚ cluster â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0 â”‚ inventory       â”‚ local   â”‚
â”‚ 1 â”‚ tenant_agent_00 â”‚ local   â”‚
â”‚ 2 â”‚ tenant_agent_01 â”‚ local   â”‚
â”‚ 3 â”‚ tenant_agent_02 â”‚ local   â”‚
â”‚ 4 â”‚ tenant_agent_03 â”‚ local   â”‚
â”‚ 5 â”‚ tenant_agent_04 â”‚ local   â”‚
â”‚ 6 â”‚ _default        â”‚ local   â”‚
â•°â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_scopes_create">4.2.2. <code>scopes create</code></h4>
<div class="paragraph">
<p>Creates a scope with the name supplied:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>ğŸ‘¤ Charlie ğŸ  local in ğŸ—„ default._default._default
&gt; scopes
â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ # â”‚  scope   â”‚ cluster â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0 â”‚ _default â”‚ local   â”‚
â•°â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
ğŸ‘¤ Charlie ğŸ  local in ğŸ—„ default._default._default
&gt; scopes create new-scope
ğŸ‘¤ Charlie ğŸ  local in ğŸ—„ default._default._default
&gt; scopes
â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ # â”‚   scope   â”‚ cluster â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0 â”‚ new-scope â”‚ local   â”‚
â”‚ 1 â”‚ _default  â”‚ local   â”‚
â•°â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_scopes_drop">4.2.3. <code>scopes drop</code></h4>
<div class="paragraph">
<p>Deletes the scope matching the given name:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>ğŸ‘¤ Charlie ğŸ  local in ğŸ—„ default._default._default
&gt; scopes
â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ # â”‚   scope   â”‚ cluster â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0 â”‚ new-scope â”‚ local   â”‚
â”‚ 1 â”‚ _default  â”‚ local   â”‚
â•°â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
ğŸ‘¤ Charlie ğŸ  local in ğŸ—„ default._default._default
&gt; scopes drop new-scope
ğŸ‘¤ Charlie ğŸ  local in ğŸ—„ default._default._default
&gt; scopes
â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ # â”‚  scope   â”‚ cluster â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0 â”‚ _default â”‚ local   â”‚
â•°â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_collections">4.3. collections</h3>
<div class="paragraph">
<p>The <code>collections</code> commands are used to manage collections.</p>
</div>
<div class="sect3">
<h4 id="_collections_2">4.3.1. <code>collections</code></h4>
<div class="paragraph">
<p>Lists all of the collections in the active scope:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>ğŸ‘¤ Charlie ğŸ  local in ğŸ—„ travel-sample.inventory._default
&gt; collections
â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ # â”‚ collection â”‚ max_expiry â”‚ cluster â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0 â”‚ landmark   â”‚ inherited  â”‚ local   â”‚
â”‚ 1 â”‚ hotel      â”‚ inherited  â”‚ local   â”‚
â”‚ 2 â”‚ airport    â”‚ inherited  â”‚ local   â”‚
â”‚ 3 â”‚ airline    â”‚ inherited  â”‚ local   â”‚
â”‚ 4 â”‚ route      â”‚ inherited  â”‚ local   â”‚
â•°â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_collections_create">4.3.2. <code>collections create</code></h4>
<div class="paragraph">
<p>Create a collection with the name supplied:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>ğŸ‘¤ Charlie ğŸ  local in ğŸ—„ my-bucket.my-scope._default
&gt; collections
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ empty list â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
ğŸ‘¤ Charlie ğŸ  local in ğŸ—„ my-bucket.my-scope._default
&gt; collections create new-collection
ğŸ‘¤ Charlie ğŸ  local in ğŸ—„ my-bucket.my-scope._default
&gt; collections
â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ # â”‚   collection   â”‚ max_expiry â”‚ cluster â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0 â”‚ new-collection â”‚ inherited  â”‚ local   â”‚
â•°â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_collections_drop">4.3.3. <code>collections drop</code></h4>
<div class="paragraph">
<p>Drop the collection matching the name given:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>ğŸ‘¤ Charlie ğŸ  local in ğŸ—„ default.my-scope._default
&gt; collections
â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ # â”‚   collection   â”‚ max_expiry â”‚ cluster â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0 â”‚ new-collection â”‚ inherited  â”‚ local   â”‚
â•°â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
ğŸ‘¤ Charlie ğŸ  local in ğŸ—„ default.my-scope._default
&gt; collections drop new-collection
ğŸ‘¤ Charlie ğŸ  local in ğŸ—„ default.my-scope._default
&gt; collections
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ empty list â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_doc">4.4. doc</h3>
<div class="paragraph">
<p>The <code>doc</code> commands are for managing the documents stored in the registered clusters.</p>
</div>
<div class="sect3">
<h4 id="_doc_get">4.4.1. <code>doc get</code></h4>
<div class="paragraph">
<p>Gets a doc from the active cluster, bucket, scope and collection:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>ğŸ‘¤ Charlie ğŸ  local in ğŸ—„ travel-sample._default._default
&gt; doc get airline_10
â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ # â”‚     id     â”‚           content            â”‚         cas         â”‚ error â”‚ cluster â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0 â”‚ airline_10 â”‚ â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•® â”‚ 1726047084573556736 â”‚       â”‚ local   â”‚
â”‚   â”‚            â”‚ â”‚ id       â”‚ 10            â”‚ â”‚                     â”‚       â”‚         â”‚
â”‚   â”‚            â”‚ â”‚ type     â”‚ airline       â”‚ â”‚                     â”‚       â”‚         â”‚
â”‚   â”‚            â”‚ â”‚ name     â”‚ 40-Mile Air   â”‚ â”‚                     â”‚       â”‚         â”‚
â”‚   â”‚            â”‚ â”‚ iata     â”‚ Q5            â”‚ â”‚                     â”‚       â”‚         â”‚
â”‚   â”‚            â”‚ â”‚ icao     â”‚ MLA           â”‚ â”‚                     â”‚       â”‚         â”‚
â”‚   â”‚            â”‚ â”‚ callsign â”‚ MILE-AIR      â”‚ â”‚                     â”‚       â”‚         â”‚
â”‚   â”‚            â”‚ â”‚ country  â”‚ United States â”‚ â”‚                     â”‚       â”‚         â”‚
â”‚   â”‚            â”‚ â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯ â”‚                     â”‚       â”‚         â”‚
â•°â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯</code></pre>
</div>
</div>
<div class="paragraph">
<p>The contents of the document are returned in the <code>content</code> column alongside the document metadata (id, cas, error and cluster).</p>
</div>
<div class="paragraph">
<p><code>doc get</code> can get multiple documents at once using an input stream:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>ğŸ‘¤ Charlie ğŸ  local in ğŸ—„ travel-sample._default._default
&gt; [airline_10 airline_10748 airline_137] | wrap id | doc get
â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ # â”‚      id       â”‚           content            â”‚         cas         â”‚ error â”‚   cluster    â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0 â”‚ airline_10    â”‚ â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•® â”‚ 1712321628975398912 â”‚       â”‚ prod-us-west â”‚
â”‚   â”‚               â”‚ â”‚ id       â”‚ 10            â”‚ â”‚                     â”‚       â”‚              â”‚
â”‚   â”‚               â”‚ â”‚ type     â”‚ airline       â”‚ â”‚                     â”‚       â”‚              â”‚
â”‚   â”‚               â”‚ â”‚ name     â”‚ 40-Mile Air   â”‚ â”‚                     â”‚       â”‚              â”‚
â”‚   â”‚               â”‚ â”‚ iata     â”‚ Q5            â”‚ â”‚                     â”‚       â”‚              â”‚
â”‚   â”‚               â”‚ â”‚ icao     â”‚ MLA           â”‚ â”‚                     â”‚       â”‚              â”‚
â”‚   â”‚               â”‚ â”‚ callsign â”‚ MILE-AIR      â”‚ â”‚                     â”‚       â”‚              â”‚
â”‚   â”‚               â”‚ â”‚ country  â”‚ United States â”‚ â”‚                     â”‚       â”‚              â”‚
â”‚   â”‚               â”‚ â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯ â”‚                     â”‚       â”‚              â”‚
â”‚ 1 â”‚ airline_137   â”‚ â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®    â”‚ 1712321633323712512 â”‚       â”‚ prod-us-west â”‚
â”‚   â”‚               â”‚ â”‚ id       â”‚ 137        â”‚    â”‚                     â”‚       â”‚              â”‚
â”‚   â”‚               â”‚ â”‚ type     â”‚ airline    â”‚    â”‚                     â”‚       â”‚              â”‚
â”‚   â”‚               â”‚ â”‚ name     â”‚ Air France â”‚    â”‚                     â”‚       â”‚              â”‚
â”‚   â”‚               â”‚ â”‚ iata     â”‚ AF         â”‚    â”‚                     â”‚       â”‚              â”‚
â”‚   â”‚               â”‚ â”‚ icao     â”‚ AFR        â”‚    â”‚                     â”‚       â”‚              â”‚
â”‚   â”‚               â”‚ â”‚ callsign â”‚ AIRFRANS   â”‚    â”‚                     â”‚       â”‚              â”‚
â”‚   â”‚               â”‚ â”‚ country  â”‚ France     â”‚    â”‚                     â”‚       â”‚              â”‚
â”‚   â”‚               â”‚ â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯    â”‚                     â”‚       â”‚              â”‚
â”‚ 2 â”‚ airline_10748 â”‚ â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•® â”‚ 1712321631323947008 â”‚       â”‚ prod-us-west â”‚
â”‚   â”‚               â”‚ â”‚ id       â”‚ 10748         â”‚ â”‚                     â”‚       â”‚              â”‚
â”‚   â”‚               â”‚ â”‚ type     â”‚ airline       â”‚ â”‚                     â”‚       â”‚              â”‚
â”‚   â”‚               â”‚ â”‚ name     â”‚ Locair        â”‚ â”‚                     â”‚       â”‚              â”‚
â”‚   â”‚               â”‚ â”‚ iata     â”‚ ZQ            â”‚ â”‚                     â”‚       â”‚              â”‚
â”‚   â”‚               â”‚ â”‚ icao     â”‚ LOC           â”‚ â”‚                     â”‚       â”‚              â”‚
â”‚   â”‚               â”‚ â”‚ callsign â”‚ LOCAIR        â”‚ â”‚                     â”‚       â”‚              â”‚
â”‚   â”‚               â”‚ â”‚ country  â”‚ United States â”‚ â”‚                     â”‚       â”‚              â”‚
â”‚   â”‚               â”‚ â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯ â”‚                     â”‚       â”‚              â”‚
â•°â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>doc get</code> will extract the id from the <code>id</code> column, which is why you need to use <a href="https://www.nushell.sh/commands/docs/wrap.html">wrap</a>.
But the <code>id</code> can be extracted from a different input column using the <code>--id-column</code> flag.</p>
</div>
</div>
<div class="sect3">
<h4 id="_doc_import">4.4.2. <code>doc import</code></h4>
<div class="paragraph">
<p>The simplest way to import data into the active cluster.
The data can be in any of the formats supported by the <a href="https://www.nushell.sh/commands/docs/from.html">from</a> command.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>ğŸ‘¤ Charlie ğŸ  local in ğŸ—„ default._default._default
&gt; cat user.json
{
  &quot;id&quot;: 123,
  &quot;name&quot;: &quot;Michael&quot;,
  &quot;age&quot;: 32,
  &quot;height&quot;: 180
}
ğŸ‘¤ Charlie ğŸ  local in ğŸ—„ default._default._default
&gt; doc import user.json
â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ # â”‚ processed â”‚ success â”‚ failed â”‚ failures â”‚ cluster â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0 â”‚         1 â”‚       1 â”‚      0 â”‚          â”‚ local   â”‚
â•°â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
ğŸ‘¤ Charlie ğŸ  local in ğŸ—„ default._default._default
&gt; doc get 123
â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ # â”‚ id  â”‚       content        â”‚         cas         â”‚ error â”‚ cluster â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0 â”‚ 123 â”‚ â•­â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â•® â”‚ 1726063078042501120 â”‚       â”‚ local   â”‚
â”‚   â”‚     â”‚ â”‚ id     â”‚ 123     â”‚ â”‚                     â”‚       â”‚         â”‚
â”‚   â”‚     â”‚ â”‚ name   â”‚ Michael â”‚ â”‚                     â”‚       â”‚         â”‚
â”‚   â”‚     â”‚ â”‚ age    â”‚ 32      â”‚ â”‚                     â”‚       â”‚         â”‚
â”‚   â”‚     â”‚ â”‚ height â”‚ 180     â”‚ â”‚                     â”‚       â”‚         â”‚
â”‚   â”‚     â”‚ â•°â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯ â”‚                     â”‚       â”‚         â”‚
â•°â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>doc import</code> will use the <code>id</code> field in the source document as the document key by default, but this behaviour can be changed with the <code>--id-column</code> flag.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>ğŸ‘¤ Charlie ğŸ  local in ğŸ—„ default._default._default
&gt; cat user.csv
name,age,height
Michael,32,180
ğŸ‘¤ Charlie ğŸ  local in ğŸ—„ default._default._default
&gt; doc import user.csv --id-column name
â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ # â”‚ processed â”‚ success â”‚ failed â”‚ failures â”‚ cluster â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0 â”‚         1 â”‚       1 â”‚      0 â”‚          â”‚ local   â”‚
â•°â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
ğŸ‘¤ Charlie ğŸ  local in ğŸ—„ default._default._default
&gt; doc get Michael
â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ # â”‚   id    â”‚       content        â”‚         cas         â”‚ error â”‚ cluster â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0 â”‚ Michael â”‚ â•­â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â•® â”‚ 1726063937243250688 â”‚       â”‚ local   â”‚
â”‚   â”‚         â”‚ â”‚ name   â”‚ Michael â”‚ â”‚                     â”‚       â”‚         â”‚
â”‚   â”‚         â”‚ â”‚ age    â”‚ 32      â”‚ â”‚                     â”‚       â”‚         â”‚
â”‚   â”‚         â”‚ â”‚ height â”‚ 180     â”‚ â”‚                     â”‚       â”‚         â”‚
â”‚   â”‚         â”‚ â•°â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯ â”‚                     â”‚       â”‚         â”‚
â•°â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
look at the many different import formats <code>from</code> supports, including csv, xml, yaml and even sqlite.
With this simple tool at hand you are able to load many different data formats quickly and import them into Couchbase!
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_doc_insert">4.4.3. <code>doc insert</code></h4>
<div class="paragraph">
<p>Inserts document into the active bucket/scope/collection:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>ğŸ‘¤ Charlie ğŸ  remote in â˜ï¸ default._default._default
&gt; open user.json
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ name   â”‚ Michael â”‚
â”‚ age    â”‚ 32      â”‚
â”‚ height â”‚ 180     â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
ğŸ‘¤ Charlie ğŸ  remote in â˜ï¸ default._default._default
&gt; open user.json | wrap content | insert id $in.content.name | doc insert
â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ # â”‚ processed â”‚ success â”‚ failed â”‚ failures â”‚ cluster â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0 â”‚         1 â”‚       1 â”‚      0 â”‚          â”‚ remote  â”‚
â•°â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯</code></pre>
</div>
</div>
<div class="paragraph">
<p>And if a document already exists in the active collection with this key then the command will fail:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>ğŸ‘¤ Charlie ğŸ  remote in â˜ï¸ default._default._default
&gt; open user.json | wrap content | insert id $in.content.name | doc insert
â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ # â”‚ processed â”‚ success â”‚ failed â”‚      failures      â”‚ cluster â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0 â”‚         1 â”‚       0 â”‚      1 â”‚ Key already exists â”‚ remote  â”‚
â•°â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯</code></pre>
</div>
</div>
<div class="paragraph">
<p>See the <a href="#_manual_import">manual import</a> section for an explanation of the formatting we do before piping to the <code>doc insert</code> command.</p>
</div>
<div class="paragraph">
<p><code>doc insert</code> can be used to insert multiple documents at once, see <a href="#_importing_data">importing data</a> for examples.</p>
</div>
</div>
<div class="sect3">
<h4 id="_doc_remove">4.4.4. <code>doc remove</code></h4>
<div class="paragraph">
<p>Removes the document with the given key from the active collection.
For example say we have the following stored:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>ğŸ‘¤ Charlie ğŸ  remote in â˜ï¸ default._default._default
&gt; doc get Michael
â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ # â”‚   id    â”‚       content        â”‚         cas         â”‚ error â”‚ cluster â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0 â”‚ Michael â”‚ â•­â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â•® â”‚ 1726821299020365824 â”‚       â”‚ remote  â”‚
â”‚   â”‚         â”‚ â”‚ name   â”‚ Michael â”‚ â”‚                     â”‚       â”‚         â”‚
â”‚   â”‚         â”‚ â”‚ age    â”‚ 32      â”‚ â”‚                     â”‚       â”‚         â”‚
â”‚   â”‚         â”‚ â”‚ height â”‚ 180     â”‚ â”‚                     â”‚       â”‚         â”‚
â”‚   â”‚         â”‚ â•°â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯ â”‚                     â”‚       â”‚         â”‚
â•°â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯</code></pre>
</div>
</div>
<div class="paragraph">
<p>We would remove it as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>ğŸ‘¤ Charlie ğŸ  remote in â˜ï¸ default._default._default
&gt; doc remove Michael
â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ # â”‚ processed â”‚ success â”‚ failed â”‚ failures â”‚ cluster â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0 â”‚         1 â”‚       1 â”‚      0 â”‚          â”‚ remote  â”‚
â•°â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯</code></pre>
</div>
</div>
<div class="paragraph">
<p>If a document matching the key cannot be found, then an error is returned:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>ğŸ‘¤ Charlie ğŸ  remote in â˜ï¸ default._default._default
&gt; doc remove Michael
â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ # â”‚ processed â”‚ success â”‚ failed â”‚   failures    â”‚ cluster â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0 â”‚         1 â”‚       0 â”‚      1 â”‚ Key not found â”‚ remote  â”‚
â•°â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also remove multiple documents at once with an input stream:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>ğŸ‘¤ Charlie ğŸ  remote in â˜ï¸ travel-sample._default._default
&gt; [airline_10 airline_10748 airline_137] | wrap id | doc remove
â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ # â”‚ processed â”‚ success â”‚ failed â”‚ failures â”‚ cluster â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0 â”‚         3 â”‚       3 â”‚      0 â”‚          â”‚ remote  â”‚
â•°â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_doc_replace">4.4.5. <code>doc replace</code></h4>
<div class="paragraph">
<p>Replaces the document in Couchbase matching the key id of the new one, if there is no document matching the <code>id</code> then an error is returned.
Say we have the following document stored in the connected cluster:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>ğŸ‘¤ Charlie ğŸ  remote in â˜ï¸ default._default._default
&gt; doc get Michael
â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ # â”‚   id    â”‚       content        â”‚         cas         â”‚ error â”‚ cluster â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0 â”‚ Michael â”‚ â•­â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â•® â”‚ 1726821687787126784 â”‚       â”‚ remote  â”‚
â”‚   â”‚         â”‚ â”‚ name   â”‚ Michael â”‚ â”‚                     â”‚       â”‚         â”‚
â”‚   â”‚         â”‚ â”‚ age    â”‚ 32      â”‚ â”‚                     â”‚       â”‚         â”‚
â”‚   â”‚         â”‚ â”‚ height â”‚ 180     â”‚ â”‚                     â”‚       â”‚         â”‚
â”‚   â”‚         â”‚ â•°â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯ â”‚                     â”‚       â”‚         â”‚
â•°â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯</code></pre>
</div>
</div>
<div class="paragraph">
<p>And we have an updated version stored locally:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>ğŸ‘¤ Charlie ğŸ  remote in â˜ï¸ default._default._default
&gt; open user.json
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ name   â”‚ Michael â”‚
â”‚ age    â”‚ 80      â”‚
â”‚ height â”‚ 110     â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯</code></pre>
</div>
</div>
<div class="paragraph">
<p>Then we can replace the first with the second using <code>doc replace</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>ğŸ‘¤ Charlie ğŸ  remote in â˜ï¸ default._default._default
&gt; open user.json | wrap content | insert id $in.content.name | doc replace
â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ # â”‚ processed â”‚ success â”‚ failed â”‚ failures â”‚ cluster â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0 â”‚         1 â”‚       1 â”‚      0 â”‚          â”‚ remote  â”‚
â•°â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
ğŸ‘¤ Charlie ğŸ  remote in â˜ï¸ default._default._default
&gt; doc get Michael
â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ # â”‚   id    â”‚       content        â”‚         cas         â”‚ error â”‚ cluster â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0 â”‚ Michael â”‚ â•­â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â•® â”‚ 1726821910540648448 â”‚       â”‚ remote  â”‚
â”‚   â”‚         â”‚ â”‚ name   â”‚ Michael â”‚ â”‚                     â”‚       â”‚         â”‚
â”‚   â”‚         â”‚ â”‚ age    â”‚ 80      â”‚ â”‚                     â”‚       â”‚         â”‚
â”‚   â”‚         â”‚ â”‚ height â”‚ 110     â”‚ â”‚                     â”‚       â”‚         â”‚
â”‚   â”‚         â”‚ â•°â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯ â”‚                     â”‚       â”‚         â”‚
â•°â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯</code></pre>
</div>
</div>
<div class="paragraph">
<p>See the <a href="#_manual_import">manual import</a> section for an explanation of the formatting we do before piping to the <code>doc replace</code> command.
If there was no document with the <code>id</code> Michael, then the replace would fail:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>ğŸ‘¤ Charlie ğŸ  remote in â˜ï¸ default._default._default
&gt; open user.json | wrap content | insert id $in.content.name | doc replace
â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ # â”‚ processed â”‚ success â”‚ failed â”‚   failures    â”‚ cluster â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0 â”‚         1 â”‚       0 â”‚      1 â”‚ Key not found â”‚ remote  â”‚
â•°â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯</code></pre>
</div>
</div>
<div class="paragraph">
<p>Similarly to <code>doc insert</code>, <code>doc replace</code> can be used to replace multiple documents at once, see <a href="#_importing_data">importing data</a> for examples.</p>
</div>
</div>
<div class="sect3">
<h4 id="_doc_upsert">4.4.6. <code>doc upsert</code></h4>
<div class="paragraph">
<p>This is the most robust way to import data into the cluster since it will work whether or not there is an existing doc in the cluster with a matching <code>id</code>.
If there is no document already in the cluster with a matching <code>id</code> then it behaves the same as <a href="#_doc_insert">doc insert</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>ğŸ‘¤ Charlie ğŸ  remote in â˜ï¸ default._default._default
&gt; doc get Michael
â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ # â”‚   id    â”‚ content â”‚ cas â”‚     error     â”‚ cluster â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0 â”‚ Michael â”‚         â”‚   0 â”‚ Key not found â”‚ remote  â”‚
â•°â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
ğŸ‘¤ Charlie ğŸ  remote in â˜ï¸ default._default._default
&gt; open user.json
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ name   â”‚ Michael â”‚
â”‚ age    â”‚ 32      â”‚
â”‚ height â”‚ 180     â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
ğŸ‘¤ Charlie ğŸ  remote in â˜ï¸ default._default._default
&gt; open user.json | wrap content | insert id $in.content.name | doc upsert
â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ # â”‚ processed â”‚ success â”‚ failed â”‚ failures â”‚ cluster â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0 â”‚         1 â”‚       1 â”‚      0 â”‚          â”‚ remote  â”‚
â•°â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
ğŸ‘¤ Charlie ğŸ  remote in â˜ï¸ default._default._default
&gt; doc get Michael
â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ # â”‚   id    â”‚       content        â”‚         cas         â”‚ error â”‚ cluster â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0 â”‚ Michael â”‚ â•­â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â•® â”‚ 1726822249315041280 â”‚       â”‚ remote  â”‚
â”‚   â”‚         â”‚ â”‚ name   â”‚ Michael â”‚ â”‚                     â”‚       â”‚         â”‚
â”‚   â”‚         â”‚ â”‚ age    â”‚ 32      â”‚ â”‚                     â”‚       â”‚         â”‚
â”‚   â”‚         â”‚ â”‚ height â”‚ 180     â”‚ â”‚                     â”‚       â”‚         â”‚
â”‚   â”‚         â”‚ â•°â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯ â”‚                     â”‚       â”‚         â”‚
â•°â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯</code></pre>
</div>
</div>
<div class="paragraph">
<p>See the <a href="#_manual_import">manual import</a> section for an explanation of the formatting we do before piping to the <code>doc upsert</code> command.</p>
</div>
<div class="paragraph">
<p>Or if there is an existing document with the same <code>id</code> then <code>upsert</code> will behave the same as a <code>replace</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>ğŸ‘¤ Charlie ğŸ  remote in â˜ï¸ default._default._default
&gt; doc get Michael
â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ # â”‚   id    â”‚       content        â”‚         cas         â”‚ error â”‚ cluster â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0 â”‚ Michael â”‚ â•­â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â•® â”‚ 1726822249315041280 â”‚       â”‚ remote  â”‚
â”‚   â”‚         â”‚ â”‚ name   â”‚ Michael â”‚ â”‚                     â”‚       â”‚         â”‚
â”‚   â”‚         â”‚ â”‚ age    â”‚ 32      â”‚ â”‚                     â”‚       â”‚         â”‚
â”‚   â”‚         â”‚ â”‚ height â”‚ 180     â”‚ â”‚                     â”‚       â”‚         â”‚
â”‚   â”‚         â”‚ â•°â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯ â”‚                     â”‚       â”‚         â”‚
â•°â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
ğŸ‘¤ Charlie ğŸ  remote in â˜ï¸ default._default._default
&gt; open user.json
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ name   â”‚ Michael â”‚
â”‚ age    â”‚ 80      â”‚
â”‚ height â”‚ 110     â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
ğŸ‘¤ Charlie ğŸ  remote in â˜ï¸ default._default._default
&gt; open user.json | wrap content | insert id $in.content.name | doc upsert
â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ # â”‚ processed â”‚ success â”‚ failed â”‚ failures â”‚ cluster â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0 â”‚         1 â”‚       1 â”‚      0 â”‚          â”‚ remote  â”‚
â•°â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
ğŸ‘¤ Charlie ğŸ  remote in â˜ï¸ default._default._default
&gt; doc get Michael
â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ # â”‚   id    â”‚       content        â”‚         cas         â”‚ error â”‚ cluster â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0 â”‚ Michael â”‚ â•­â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â•® â”‚ 1726822368839598080 â”‚       â”‚ remote  â”‚
â”‚   â”‚         â”‚ â”‚ name   â”‚ Michael â”‚ â”‚                     â”‚       â”‚         â”‚
â”‚   â”‚         â”‚ â”‚ age    â”‚ 80      â”‚ â”‚                     â”‚       â”‚         â”‚
â”‚   â”‚         â”‚ â”‚ height â”‚ 110     â”‚ â”‚                     â”‚       â”‚         â”‚
â”‚   â”‚         â”‚ â•°â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯ â”‚                     â”‚       â”‚         â”‚
â•°â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_nodes">4.5. <code>nodes</code></h3>
<div class="paragraph">
<p>The <code>nodes</code> command allows you to list all the nodes of the cluster you are currently connected to.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>&gt; nodes
â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ # â”‚   cluster    â”‚       hostname       â”‚ status  â”‚         services         â”‚        version        â”‚            os             â”‚ memory_total â”‚ memory_free â”‚ capella â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0 â”‚ prod-us-west â”‚ 192.168.107.128:8091 â”‚ healthy â”‚ search,indexing,kv,query â”‚ 7.6.2-3505-enterprise â”‚ aarch64-unknown-linux-gnu â”‚   6201221120 â”‚  2227081216 â”‚ false   â”‚
â”‚ 1 â”‚ prod-us-west â”‚ 192.168.107.129:8091 â”‚ healthy â”‚ search,indexing,kv,query â”‚ 7.6.2-3505-enterprise â”‚ aarch64-unknown-linux-gnu â”‚   6201221120 â”‚  2204721152 â”‚ false   â”‚
â”‚ 2 â”‚ prod-us-west â”‚ 192.168.107.130:8091 â”‚ healthy â”‚ search,indexing,kv,query â”‚ 7.6.2-3505-enterprise â”‚ aarch64-unknown-linux-gnu â”‚   6201221120 â”‚  2209816576 â”‚ false   â”‚
â•°â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_subdoc_get">4.6. <code>subdoc get</code></h3>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>&gt; subdoc get --help
Fetches the value of the provided path in the specified document through the data service

Usage:
  &gt; subdoc get {flags} &lt;path&gt; (id)

Flags:
  -h, --help - Display the help message for this command
  --id-column &lt;String&gt; - the name of the id column if used with an input stream
  --bucket &lt;String&gt; - the name of the bucket
  --scope &lt;String&gt; - the name of the scope
  --collection &lt;String&gt; - the name of the collection
  --clusters &lt;String&gt; - the clusters which should be contacted
  --batch-size &lt;Number&gt; - the maximum number of items to batch send at a time
  -e, --halt-on-error - halt on any errors

Parameters:
  path &lt;any&gt;: the path(s) to be fetched from the documents
  id &lt;string&gt;: the document id (optional)</code></pre>
</div>
</div>
<div class="paragraph">
<p>It can be used to retrieve a field from a single document:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>ğŸ‘¤ Administrator ğŸ  cluster in ğŸ—„ travel-sample._default._default
&gt; subdoc get address landmark_10019
â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ # â”‚       id       â”‚           content           â”‚         cas         â”‚ error â”‚ cluster â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0 â”‚ landmark_10019 â”‚ Prince Arthur Road, ME4 4UG â”‚ 1722410659053961216 â”‚       â”‚ local   â”‚
â•°â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯</code></pre>
</div>
</div>
<div class="paragraph">
<p>Or similarly to the <code>doc</code> commands a stream of ids can be provided:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>ğŸ‘¤ Administrator ğŸ  cluster in ğŸ—„ travel-sample._default._default
&gt; [landmark_10019 landmark_10020] | subdoc get address
â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ # â”‚       id       â”‚           content           â”‚         cas         â”‚ error â”‚ cluster â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0 â”‚ landmark_10019 â”‚ Prince Arthur Road, ME4 4UG â”‚ 1722410659053961216 â”‚       â”‚ local   â”‚
â”‚ 1 â”‚ landmark_10020 â”‚ 4 High Street, ME7 1BB      â”‚ 1722410654151999488 â”‚       â”‚ local   â”‚
â•°â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯</code></pre>
</div>
</div>
<div class="paragraph">
<p>The path parameter can be a list, allowing retrieval of multiple fields in one or more docs:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>ğŸ‘¤ Administrator ğŸ  cluster in ğŸ—„ travel-sample._default._default
&gt; [landmark_10019 landmark_10020] | subdoc get [name, address]
â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ # â”‚       id       â”‚                  content                  â”‚         cas         â”‚ error â”‚ cluster â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0 â”‚ landmark_10019 â”‚ â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•® â”‚ 1722410659053961216 â”‚       â”‚ local   â”‚
â”‚   â”‚                â”‚ â”‚ name    â”‚ Royal Engineers Museum      â”‚ â”‚                     â”‚       â”‚         â”‚
â”‚   â”‚                â”‚ â”‚ address â”‚ Prince Arthur Road, ME4 4UG â”‚ â”‚                     â”‚       â”‚         â”‚
â”‚   â”‚                â”‚ â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯ â”‚                     â”‚       â”‚         â”‚
â”‚ 1 â”‚ landmark_10020 â”‚ â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®      â”‚ 1722410654151999488 â”‚       â”‚ local   â”‚
â”‚   â”‚                â”‚ â”‚ name    â”‚ Hollywood Bowl         â”‚      â”‚                     â”‚       â”‚         â”‚
â”‚   â”‚                â”‚ â”‚ address â”‚ 4 High Street, ME7 1BB â”‚      â”‚                     â”‚       â”‚         â”‚
â”‚   â”‚                â”‚ â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯      â”‚                     â”‚       â”‚         â”‚
â•°â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_query">4.7. query</h3>
<div class="paragraph">
<p>The query commands can be used to explore/create indexes and execute queries.</p>
</div>
<div class="sect3">
<h4 id="_query_2">4.7.1. <code>query</code></h4>
<div class="paragraph">
<p>Takes a N1QL statement and executes it against the active cluster.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>ğŸ‘¤ Charlie  ğŸ  local in ğŸ—„ travel-sample._default._default
&gt; query &quot;SELECT meta().id FROM `travel-sample`.inventory.landmark WHERE country = 'France'&quot;
â•­â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚   # â”‚       id       â”‚ cluster â”‚
â”œâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   0 â”‚ landmark_10061 â”‚ local   â”‚
â”‚ ... â”‚       ...      â”‚   ...   â”‚
â”‚ 387 â”‚ landmark_9838  â”‚ local   â”‚
â•°â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯</code></pre>
</div>
</div>
<div class="paragraph">
<p>The query gets all the IDs of the docs where the country is France, then <code>cbsh</code> appends the cluster column to the results.</p>
</div>
<div class="paragraph">
<p>Named parameters are supported through the <code>--params</code> flag when the argument is a json object:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>ğŸ‘¤ Charlie  ğŸ  local in ğŸ—„ travel-sample._default._default
&gt; query &quot;SELECT meta().id FROM `travel-sample`.inventory.landmark WHERE country = $country&quot; --params {country: France}
â•­â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚   # â”‚       id       â”‚ cluster â”‚
â”œâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   0 â”‚ landmark_10061 â”‚ local   â”‚
â”‚ ... â”‚       ...      â”‚   ...   â”‚
â”‚ 387 â”‚ landmark_9838  â”‚ local   â”‚
â•°â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯</code></pre>
</div>
</div>
<div class="paragraph">
<p>Multiple named parameters can be used at once, note there is no need to separate them with commas:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>ğŸ‘¤ Charlie  ğŸ  local in ğŸ—„ travel-sample._default._default
&gt; query &quot;SELECT airline FROM `travel-sample`.inventory.route WHERE sourceairport = $aval AND distance &gt; $dval&quot; --params {aval: LAX dval: 13000}
â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ # â”‚ airline â”‚ cluster â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0 â”‚ B6      â”‚ local   â”‚
â”‚ 1 â”‚ EK      â”‚ local   â”‚
â”‚ 2 â”‚ SV      â”‚ local   â”‚
â•°â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯</code></pre>
</div>
</div>
<div class="paragraph">
<p>The wildcard character '%' can be used the same as inside of the query statement.
The following finds any IDs that match the regex 'hotel1002*'.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>ğŸ‘¤ Charlie  ğŸ  local in ğŸ—„ travel-sample._default._default
&gt; query &quot;SELECT meta().id FROM `travel-sample`.inventory.hotel WHERE meta().id LIKE $pattern&quot; --params {pattern: hotel_1002%}
â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ # â”‚     id      â”‚ cluster â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0 â”‚ hotel_10025 â”‚ local   â”‚
â”‚ 1 â”‚ hotel_10026 â”‚ local   â”‚
â•°â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯</code></pre>
</div>
</div>
<div class="paragraph">
<p>Positional parameters are also supported when the <code>--params</code> flag takes a <a href="https://www.nushell.sh/book/working_with_lists.html">list</a> argument:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>ğŸ‘¤ Charlie ğŸ  local
&gt; query &quot;SELECT airline FROM `travel-sample`.inventory.route WHERE sourceairport = $1 AND distance &gt; $2&quot; --params [LAX 13000]
â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ # â”‚ airline â”‚ cluster â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0 â”‚ B6      â”‚ local   â”‚
â”‚ 1 â”‚ EK      â”‚ local   â”‚
â”‚ 2 â”‚ SV      â”‚ local   â”‚
â•°â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_query_advise">4.7.2. <code>query advise</code></h4>
<div class="paragraph">
<p>Helps you to learn about the indexes that your queries are using, and what indexes
you could create to make them faster. For example we can take the first query from the <code>query</code> examples:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>&gt; query advise &quot;SELECT meta().id FROM `travel-sample`.inventory.landmark WHERE country = 'France'&quot;
â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â•®
â”‚ # â”‚ #operator â”‚                                                                                                           advice                                                                                                            â”‚ ... â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¤
â”‚ 0 â”‚ Advise    â”‚ â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•® â”‚ ... â”‚
â”‚   â”‚           â”‚ â”‚ #operator  â”‚ IndexAdvice                                                                                                                                                                                                â”‚ â”‚     â”‚
â”‚   â”‚           â”‚ â”‚            â”‚ â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•® â”‚ â”‚     â”‚
â”‚   â”‚           â”‚ â”‚ adviseinfo â”‚ â”‚                     â”‚ â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®                                                 â”‚ â”‚ â”‚     â”‚
â”‚   â”‚           â”‚ â”‚            â”‚ â”‚ current_indexes     â”‚ â”‚ # â”‚                                             index_statement                                             â”‚ keyspace_alias â”‚                                                 â”‚ â”‚ â”‚     â”‚
â”‚   â”‚           â”‚ â”‚            â”‚ â”‚                     â”‚ â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                                                 â”‚ â”‚ â”‚     â”‚
â”‚   â”‚           â”‚ â”‚            â”‚ â”‚                     â”‚ â”‚ 0 â”‚ CREATE PRIMARY INDEX def_inventory_landmark_primary ON `default`:`travel-sample`.`inventory`.`landmark` â”‚ landmark       â”‚                                                 â”‚ â”‚ â”‚     â”‚
â”‚   â”‚           â”‚ â”‚            â”‚ â”‚                     â”‚ â•°â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯                                                 â”‚ â”‚ â”‚     â”‚
â”‚   â”‚           â”‚ â”‚            â”‚ â”‚                     â”‚ â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•® â”‚ â”‚ â”‚     â”‚
â”‚   â”‚           â”‚ â”‚            â”‚ â”‚ recommended_indexes â”‚ â”‚                  â”‚ â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®                                          â”‚ â”‚ â”‚ â”‚     â”‚
â”‚   â”‚           â”‚ â”‚            â”‚ â”‚                     â”‚ â”‚ covering_indexes â”‚ â”‚ # â”‚                                     index_statement                                     â”‚ keyspace_alias â”‚                                          â”‚ â”‚ â”‚ â”‚     â”‚
â”‚   â”‚           â”‚ â”‚            â”‚ â”‚                     â”‚ â”‚                  â”‚ â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                                          â”‚ â”‚ â”‚ â”‚     â”‚
â”‚   â”‚           â”‚ â”‚            â”‚ â”‚                     â”‚ â”‚                  â”‚ â”‚ 0 â”‚ CREATE INDEX adv_country ON `default`:`travel-sample`.`inventory`.`landmark`(`country`) â”‚ landmark       â”‚                                          â”‚ â”‚ â”‚ â”‚     â”‚
â”‚   â”‚           â”‚ â”‚            â”‚ â”‚                     â”‚ â”‚                  â”‚ â•°â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯                                          â”‚ â”‚ â”‚ â”‚     â”‚
â”‚   â”‚           â”‚ â”‚            â”‚ â”‚                     â”‚ â”‚                  â”‚ â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•® â”‚ â”‚ â”‚ â”‚     â”‚
â”‚   â”‚           â”‚ â”‚            â”‚ â”‚                     â”‚ â”‚ indexes          â”‚ â”‚ # â”‚                                     index_statement                                     â”‚ keyspace_alias â”‚           recommending_rule            â”‚ â”‚ â”‚ â”‚ â”‚     â”‚
â”‚   â”‚           â”‚ â”‚            â”‚ â”‚                     â”‚ â”‚                  â”‚ â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚ â”‚ â”‚ â”‚     â”‚
â”‚   â”‚           â”‚ â”‚            â”‚ â”‚                     â”‚ â”‚                  â”‚ â”‚ 0 â”‚ CREATE INDEX adv_country ON `default`:`travel-sample`.`inventory`.`landmark`(`country`) â”‚ landmark       â”‚ Index keys follow order of predicate   â”‚ â”‚ â”‚ â”‚ â”‚     â”‚
â”‚   â”‚           â”‚ â”‚            â”‚ â”‚                     â”‚ â”‚                  â”‚ â”‚   â”‚                                                                                         â”‚                â”‚ types: 2. equality/null/missing.       â”‚ â”‚ â”‚ â”‚ â”‚     â”‚
â”‚   â”‚           â”‚ â”‚            â”‚ â”‚                     â”‚ â”‚                  â”‚ â•°â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯ â”‚ â”‚ â”‚ â”‚     â”‚
â”‚   â”‚           â”‚ â”‚            â”‚ â”‚                     â”‚ â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯ â”‚ â”‚ â”‚     â”‚
â”‚   â”‚           â”‚ â”‚            â”‚ â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯ â”‚ â”‚     â”‚
â”‚   â”‚           â”‚ â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯ â”‚     â”‚
â•°â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â•¯</code></pre>
</div>
</div>
<div class="paragraph">
<p>This shows our query statement uses the Primary index <code>def_inventory_landmark_primary</code> and also recommends a covering index that we can create using <code>query</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>&gt; query &quot;CREATE INDEX adv_country ON `default`:`travel-sample`.`inventory`.`landmark`(`country`)&quot;</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_query_indexes">4.7.3. <code>query indexes</code></h4>
<div class="paragraph">
<p>Lists all of the query indexes.
If we had just created the recommended index at the end of the <code>query advise</code> section, the nushell command <code>find</code> can be used in conjunction with <code>query indexes</code> to check it was successfully created.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>&gt; query indexes | find adv_country
â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ # â”‚    bucket     â”‚ condition â”‚     index_key     â”‚ keyspace â”‚    name     â”‚ primary â”‚   scope   â”‚ state  â”‚ type â”‚ cluster â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0 â”‚ travel-sample â”‚           â”‚ â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•® â”‚ landmark â”‚ adv_country â”‚ false   â”‚ inventory â”‚ online â”‚ gsi  â”‚ local   â”‚
â”‚   â”‚               â”‚           â”‚ â”‚ 0 â”‚ `country` â”‚ â”‚          â”‚             â”‚         â”‚           â”‚        â”‚      â”‚         â”‚
â”‚   â”‚               â”‚           â”‚ â•°â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯ â”‚          â”‚             â”‚         â”‚           â”‚        â”‚      â”‚         â”‚
â•°â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯</code></pre>
</div>
</div>
<div class="paragraph">
<p>And if we want to check the definition this can be done using the <code>--definitions</code> flag:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>&gt; query indexes --definitions | find adv_country
â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ # â”‚    bucket     â”‚   scope   â”‚ collection â”‚    name     â”‚ status â”‚ storage_mode â”‚ replicas â”‚                                   definition                                    â”‚ cluster â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0 â”‚ travel-sample â”‚ inventory â”‚ landmark   â”‚ adv_country â”‚ Ready  â”‚ plasma       â”‚        0 â”‚ CREATE INDEX `adv_country` ON `travel-sample`.`inventory`.`landmark`(`country`) â”‚ local   â”‚
â•°â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯</code></pre>
</div>
</div>
<div class="paragraph">
<p>Check this <a href="https://couchbase.sh/docs/recipes.html#_migrating_query_index_definitions">snippet</a> to see how <code>query indexes</code> can be used to to migrate indexes between clusters.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_vector">4.8. vector</h3>
<div class="paragraph">
<p>The vector commands make it easy to explore the value that vector search can add to your data.
Check the recipes for how the vector commands can be combined to implement <a href="https://couchbase.sh/docs/recipes.html#_similarity_search">similarity search</a> or <a href="https://couchbase.sh/docs/recipes.html#_simple_rag">simple RAG</a>.</p>
</div>
<div class="sect3">
<h4 id="_vector_search">4.8.1. <code>vector search</code></h4>
<div class="paragraph">
<p>Performs a vector search against a named vector index.
Requires a vector to be used as the source of the search which can be supplied in a couple of formats.</p>
</div>
<div class="paragraph">
<p>For example imagine we have the following document stored in our cluster:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>&gt; doc get landmark_10019
â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â•®
â”‚ # â”‚       id       â”‚                                                                                                      content                                                                                                      â”‚ ... â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¤
â”‚ 0 â”‚ landmark_10019 â”‚ â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•® â”‚ ... â”‚
â”‚   â”‚                â”‚ â”‚ title         â”‚ Gillingham (Kent)                                                                                                                                                                             â”‚ â”‚     â”‚
â”‚   â”‚                â”‚ â”‚ name          â”‚ Royal Engineers Museum                                                                                                                                                                        â”‚ â”‚     â”‚
â”‚   â”‚                â”‚ â”‚ alt           â”‚                                                                                                                                                                                               â”‚ â”‚     â”‚
â”‚   â”‚                â”‚ â”‚ address       â”‚ Prince Arthur Road, ME4 4UG                                                                                                                                                                   â”‚ â”‚     â”‚
â”‚   â”‚                â”‚ â”‚ directions    â”‚                                                                                                                                                                                               â”‚ â”‚     â”‚
â”‚   â”‚                â”‚ â”‚ phone         â”‚ +44 1634 822839                                                                                                                                                                               â”‚ â”‚     â”‚
â”‚   â”‚                â”‚ â”‚ tollfree      â”‚                                                                                                                                                                                               â”‚ â”‚     â”‚
â”‚   â”‚                â”‚ â”‚ email         â”‚                                                                                                                                                                                               â”‚ â”‚     â”‚
â”‚   â”‚                â”‚ â”‚ url           â”‚ http://www.remuseum.org.uk                                                                                                                                                                    â”‚ â”‚     â”‚
â”‚   â”‚                â”‚ â”‚ hours         â”‚ Tues - Fri 9.00am to 5.00pm, Sat - Sun 11.30am - 5.00pm                                                                                                                                       â”‚ â”‚     â”‚
â”‚   â”‚                â”‚ â”‚ image         â”‚                                                                                                                                                                                               â”‚ â”‚     â”‚
â”‚   â”‚                â”‚ â”‚ price         â”‚                                                                                                                                                                                               â”‚ â”‚     â”‚
â”‚   â”‚                â”‚ â”‚ content       â”‚ Adult - Â£6.99 for an Adult ticket that allows you to come back for further visits within a year (children's and concessionary tickets also available). Museum on military engineering and the â”‚ â”‚     â”‚
â”‚   â”‚                â”‚ â”‚               â”‚  history of the British Empire. A quite extensive collection that takes about half a day to see. Of most interest to fans of British and military history or civil engineering. The outside   â”‚ â”‚     â”‚
â”‚   â”‚                â”‚ â”‚               â”‚ collection of tank mounted bridges etc can be seen for free. There is also an extensive series of themed special event weekends, admission to which is included in the cost of the annual     â”‚ â”‚     â”‚
â”‚   â”‚                â”‚ â”‚               â”‚ ticket.                                                                                                                                                                                       â”‚ â”‚     â”‚
â”‚   â”‚                â”‚ â”‚               â”‚ â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®                                                                                                                                                             â”‚ â”‚     â”‚
â”‚   â”‚                â”‚ â”‚ geo           â”‚ â”‚ lat      â”‚ 51.39              â”‚                                                                                                                                                             â”‚ â”‚     â”‚
â”‚   â”‚                â”‚ â”‚               â”‚ â”‚ lon      â”‚ 0.54               â”‚                                                                                                                                                             â”‚ â”‚     â”‚
â”‚   â”‚                â”‚ â”‚               â”‚ â”‚ accuracy â”‚ RANGE_INTERPOLATED â”‚                                                                                                                                                             â”‚ â”‚     â”‚
â”‚   â”‚                â”‚ â”‚               â”‚ â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯                                                                                                                                                             â”‚ â”‚     â”‚
â”‚   â”‚                â”‚ â”‚ activity      â”‚ see                                                                                                                                                                                           â”‚ â”‚     â”‚
â”‚   â”‚                â”‚ â”‚ type          â”‚ landmark                                                                                                                                                                                      â”‚ â”‚     â”‚
â”‚   â”‚                â”‚ â”‚ id            â”‚ 10019                                                                                                                                                                                         â”‚ â”‚     â”‚
â”‚   â”‚                â”‚ â”‚ country       â”‚ United Kingdom                                                                                                                                                                                â”‚ â”‚     â”‚
â”‚   â”‚                â”‚ â”‚ city          â”‚ Gillingham                                                                                                                                                                                    â”‚ â”‚     â”‚
â”‚   â”‚                â”‚ â”‚ state         â”‚                                                                                                                                                                                               â”‚ â”‚     â”‚
â”‚   â”‚                â”‚ â”‚               â”‚ â•­â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â•®                                                                                                                                                                              â”‚ â”‚     â”‚
â”‚   â”‚                â”‚ â”‚ contentVector â”‚ â”‚    0 â”‚  0.02 â”‚                                                                                                                                                                              â”‚ â”‚     â”‚
â”‚   â”‚                â”‚ â”‚               â”‚ â”‚  ... â”‚   ... â”‚                                                                                                                                                                              â”‚ â”‚     â”‚
â”‚   â”‚                â”‚ â”‚               â”‚ â”‚ 1023 â”‚ -0.00 â”‚                                                                                                                                                                              â”‚ â”‚     â”‚
â”‚   â”‚                â”‚ â”‚               â”‚ â•°â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â•¯                                                                                                                                                                              â”‚ â”‚     â”‚
â”‚   â”‚                â”‚ â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯ â”‚     â”‚
â•°â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â•¯</code></pre>
</div>
</div>
<div class="paragraph">
<p>The field <code>contentVector</code> contains a vector of dimension 1024 that could be used as the input to a vector search.
Due to the format of the data returned by  <a href="https://couchbase.sh/docs/#_doc_get">doc get</a> we need to <a href="https://www.nushell.sh/commands/docs/flatten.html">flatten</a> to remove the nesting then <a href="https://www.nushell.sh/commands/docs/select.html">select</a> the <code>contentVector</code> field:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>&gt; doc get landmark_10019 | flatten | select contentVector
â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ # â”‚  contentVector   â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0 â”‚ â•­â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â•® â”‚
â”‚   â”‚ â”‚    0 â”‚  0.03 â”‚ â”‚
â”‚   â”‚ â”‚ ...  â”‚  ...  â”‚ â”‚
â”‚   â”‚ â”‚ 1023 â”‚ -0.00 â”‚ â”‚
â”‚   â”‚ â•°â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â•¯ â”‚
â•°â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯</code></pre>
</div>
</div>
<div class="paragraph">
<p>This can then be piped directly into <code>vector search</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>&gt; doc get landmark_10019 | flatten | select contentVector | vector search landmark-content-index contentVector
â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ # â”‚       id       â”‚                  score                  â”‚ cluster â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0 â”‚ landmark_10019 â”‚ 340282350000000000000000000000000000000 â”‚ local   â”‚
â”‚ 1 â”‚ landmark_28965 â”‚ 1.0286634                               â”‚ local   â”‚
â”‚ 2 â”‚ landmark_3547  â”‚ 1.0150017                               â”‚ local   â”‚
â•°â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯</code></pre>
</div>
</div>
<div class="paragraph">
<p>We specify the vector index to be queried (landmark-content-index) as well as the name of the field on which the vector index was created (contentVector).
See <a href="#_vector_create_index">vector create-index</a> for further explanation.</p>
</div>
<div class="paragraph">
<p><a href="#_subdoc_get">Subdoc get</a> can also be used to fetch the source vector:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>&gt; subdoc get contentVector landmark_10019 | select content | vector search landmark-content-index contentVector
â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ # â”‚       id       â”‚                  score                  â”‚ cluster â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0 â”‚ landmark_10019 â”‚ 340282350000000000000000000000000000000 â”‚ local   â”‚
â”‚ 1 â”‚ landmark_28965 â”‚ 1.0286634                               â”‚ local   â”‚
â”‚ 2 â”‚ landmark_3547  â”‚ 1.0150017                               â”‚ local   â”‚
â•°â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯</code></pre>
</div>
</div>
<div class="paragraph">
<p>Here we don&#8217;t need to flatten and specify the field since the content of the <code>sub doc</code> output already only holds the <code>contentVector</code> field.</p>
</div>
<div class="paragraph">
<p>Another format that is accepted is the output of  <a href="#_vector_enrich_text">vector enrich-text</a> :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>&gt; vector enrich-text &quot;some string&quot; --dimension 1024 | vector search landmark-content-index contentVector
Embedding batch 1/1
â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ # â”‚       id       â”‚   score    â”‚ cluster â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0 â”‚ landmark_21681 â”‚ 0.70561004 â”‚ local   â”‚
â”‚ 1 â”‚ landmark_20732 â”‚ 0.7003826  â”‚ local   â”‚
â”‚ 2 â”‚ landmark_21682 â”‚ 0.6987926  â”‚ local   â”‚
â•°â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note the <code>--dimension</code> flag used here, the vector provided as the source of the search must match the dimension of the vectors on which the index was <a href="#_vector_create_index">created</a> else you will get no results.</p>
</div>
<div class="paragraph">
<p>Finally if you just have a plain vector that is a list of floats this can be passed in as a final positional parameter:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>&gt; let vector = [0.1 0.2 0.3 0.4]
&gt; vector search vector-index fieldName $vector</code></pre>
</div>
</div>
<div class="paragraph">
<p>The vector here only has a dimension of 4 which is unrealistically low, but it is used for illustrative purposes.</p>
</div>
<div class="paragraph">
<p>The output of the search is a table containing the IDs of the <code>n</code> (specified by the <code>--neighbours</code> flag) documents with the most similar vector in the field named.
The similarity of vectors is calculated using the metric specified on <a href="#_vector_create_index">index creation</a>.</p>
</div>
<div class="paragraph">
<p>To see the contents of the documents identified in the table simply pipe the output of vector search into a <a href="https://couchbase.sh/docs/#_doc_get">doc get</a> command.
If only interested in a particular field then the <a href="#_subdoc_get">subdoc get</a> command will also work in the same way:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>ğŸ‘¤ Charlie ğŸ  local in â˜ï¸ default._default._default
&gt; vector search landmark-content-index contentVector $vector | subdoc get address
â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ # â”‚       id       â”‚                content                â”‚         cas         â”‚ error â”‚ cluster â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0 â”‚ landmark_11956 â”‚ Hornchurch Road, Hornchurch, RM11 1JU â”‚ 1722871671832641536 â”‚       â”‚ local   â”‚
â”‚ 1 â”‚ landmark_25284 â”‚ 4040 Twiggs St                        â”‚ 1722871685304025088 â”‚       â”‚ local   â”‚
â”‚ 2 â”‚ landmark_7744  â”‚ Grandstand Road                       â”‚ 1722871709487202304 â”‚       â”‚ local   â”‚
â•°â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯</code></pre>
</div>
</div>
<div class="paragraph">
<p>The environment is important when using the <code>vector search</code> command as the fully qualified index name is constructed from the active bucket and scope.
The above command will be trying to use the index <code>default._default.landmark-content-index</code>.
If the index was created against a different bucket/scope then you will get an index not found error.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>ğŸ‘¤ Charlie ğŸ  local in ğŸ—„ travel-sample.inventory._default
&gt; vector search landmark-content-index contentVector $vector
Error:   Ã— Unexpected status code
   â•­â”€[entry #4:1:1]
 1 â”‚ vector search landmark-content-index contentVector $vector
   Â· â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€
   Â·       â•°â”€â”€
   â•°â”€â”€â”€â”€
  help: Unexpected status code: 400, body: {&quot;error&quot;:&quot;rest_auth: preparePerms, err: index not found&quot;,&quot;request&quot;:{&quot;ctl&quot;:{&quot;timeout&quot;:75000},&quot;knn&quot;:[{&quot;field&quot;:&quot;contentVector&quot;,&quot;k&quot;:3,&quot;vector&quot;:
  ...</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you want to use an index that was created against a different bucket/scope to those that are active, this can be done with the <code>--bucket</code> and <code>--scope</code> flags.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>ğŸ‘¤ Charlie ğŸ  local in ğŸ—„ travel-sample.inventory._default
&gt; vector search landmark-content-index contentVector $vector --bucket default --scope _default
â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ # â”‚       id       â”‚                  score                  â”‚ cluster â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0 â”‚ landmark_10019 â”‚ 340282350000000000000000000000000000000 â”‚ local   â”‚
â”‚ 1 â”‚ landmark_16379 â”‚ 1.0082568                               â”‚ local   â”‚
â”‚ 2 â”‚ landmark_33857 â”‚ 0.9897698                               â”‚ local   â”‚
â•°â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_vector_create_index">4.8.2. <code>vector create-index</code></h4>
<div class="paragraph">
<p>Creates a vector index against the active bucket/scope or the bucket/scope specified with the corresponding flags.
For example the following will create an index named new-vector-index over the field fieldName in documents in the bucket <code>default</code> and the scope <code>_default</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>ğŸ‘¤ Charlie ğŸ  local in â˜ï¸ default._default._default
&gt; vector create-index new-vector-index fieldName 1024</code></pre>
</div>
</div>
<div class="paragraph">
<p>Any documents located elsewhere will not be indexed, and a vector search performed with this index will not find them.
If the documents to be indexed were stored elsewhere then the environment would need to be changed with <code>cb-env bucket/scope</code> or the bucket and scope could be passed in with the appropriate flags.</p>
</div>
<div class="paragraph">
<p>The field parameter is the name of the field in the documents that contains the vector, and the dimension (length of the vector) parameter must match that of the vectors contained in the named field.
Imagine there are documents with the following structure in the bucket <code>users</code> and scope <code>embeddedUsers</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>{
    &quot;name&quot;: &quot;my-name&quot;,
    &quot;e-mail&quot;: &quot;shell-user@couchbase.com&quot;,
    &quot;description&quot;: &quot;A rich textual description of the user.&quot;,
    &quot;descriptionEmbedding&quot;: [0.0178287, 0.123098, -0.0189239, 1.109238],
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example the descriptionEmbedding is the result of using a large language model to generate an embedding from the description field.
The dimension of the vector (4) is unrealistically low but it&#8217;s been chosen for illustrative purposes.
To create an index over such documents in order to find users with similar descriptions the command would be:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>ğŸ‘¤ Charlie ğŸ  local in â˜ï¸ users.embeddedUsers._default
&gt; vector create-index user-description-index descriptionEmbedding 4

or

ğŸ‘¤ Charlie ğŸ  local in â˜ï¸ default._default._default
&gt; vector create-index user-description-index descriptionEmbedding 4 --bucket users --scope embeddedUsers</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the first example the create command is run from within the bucket and scope that the documents are stored in.
Whereas in the latter the environment values need to be overwritten with the <code>--bucket</code> and <code>--scope</code> flags to correctly create the index.</p>
</div>
</div>
<div class="sect3">
<h4 id="_vector_enrich_doc">4.8.3. <code>vector enrich-doc</code></h4>
<div class="paragraph">
<p>Enriches an existing json document by generating an embedding using the <a href="#_cb_env_llm">active llm</a> from a named field and storing it in a new field in the same document.</p>
</div>
<div class="paragraph">
<p>For example take one of the documents from the travel sample data set:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>&gt; doc get landmark_10019
â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â•®
â”‚ # â”‚       id       â”‚                                                                                                        content                                                                                                         â”‚ ... â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¤
â”‚ 0 â”‚ landmark_10019 â”‚ â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•® â”‚ ... â”‚
â”‚   â”‚                â”‚ â”‚ title      â”‚ Gillingham (Kent)                                                                                                                                                                                     â”‚ â”‚     â”‚
â”‚   â”‚                â”‚ â”‚ name       â”‚ Royal Engineers Museum                                                                                                                                                                                â”‚ â”‚     â”‚
â”‚   â”‚                â”‚ â”‚ alt        â”‚                                                                                                                                                                                                       â”‚ â”‚     â”‚
â”‚   â”‚                â”‚ â”‚ address    â”‚ Prince Arthur Road, ME4 4UG                                                                                                                                                                           â”‚ â”‚     â”‚
â”‚   â”‚                â”‚ â”‚ directions â”‚                                                                                                                                                                                                       â”‚ â”‚     â”‚
â”‚   â”‚                â”‚ â”‚ phone      â”‚ +44 1634 822839                                                                                                                                                                                       â”‚ â”‚     â”‚
â”‚   â”‚                â”‚ â”‚ tollfree   â”‚                                                                                                                                                                                                       â”‚ â”‚     â”‚
â”‚   â”‚                â”‚ â”‚ email      â”‚                                                                                                                                                                                                       â”‚ â”‚     â”‚
â”‚   â”‚                â”‚ â”‚ url        â”‚ http://www.remuseum.org.uk                                                                                                                                                                            â”‚ â”‚     â”‚
â”‚   â”‚                â”‚ â”‚ hours      â”‚ Tues - Fri 9.00am to 5.00pm, Sat - Sun 11.30am - 5.00pm                                                                                                                                               â”‚ â”‚     â”‚
â”‚   â”‚                â”‚ â”‚ image      â”‚                                                                                                                                                                                                       â”‚ â”‚     â”‚
â”‚   â”‚                â”‚ â”‚ price      â”‚                                                                                                                                                                                                       â”‚ â”‚     â”‚
â”‚   â”‚                â”‚ â”‚ content    â”‚ Adult - Â£6.99 for an Adult ticket that allows you to come back for further visits within a year (children's and concessionary tickets also available). Museum on military engineering and the history â”‚ â”‚     â”‚
â”‚   â”‚                â”‚ â”‚            â”‚  of the British Empire. A quite extensive collection that takes about half a day to see. Of most interest to fans of British and military history or civil engineering. The outside collection of     â”‚ â”‚     â”‚
â”‚   â”‚                â”‚ â”‚            â”‚ tank mounted bridges etc can be seen for free. There is also an extensive series of themed special event weekends, admission to which is included in the cost of the annual ticket.                   â”‚ â”‚     â”‚
â”‚   â”‚                â”‚ â”‚            â”‚ â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®                                                                                                                                                                     â”‚ â”‚     â”‚
â”‚   â”‚                â”‚ â”‚ geo        â”‚ â”‚ lat      â”‚ 51.39              â”‚                                                                                                                                                                     â”‚ â”‚     â”‚
â”‚   â”‚                â”‚ â”‚            â”‚ â”‚ lon      â”‚ 0.54               â”‚                                                                                                                                                                     â”‚ â”‚     â”‚
â”‚   â”‚                â”‚ â”‚            â”‚ â”‚ accuracy â”‚ RANGE_INTERPOLATED â”‚                                                                                                                                                                     â”‚ â”‚     â”‚
â”‚   â”‚                â”‚ â”‚            â”‚ â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯                                                                                                                                                                     â”‚ â”‚     â”‚
â”‚   â”‚                â”‚ â”‚ activity   â”‚ see                                                                                                                                                                                                   â”‚ â”‚     â”‚
â”‚   â”‚                â”‚ â”‚ type       â”‚ landmark                                                                                                                                                                                              â”‚ â”‚     â”‚
â”‚   â”‚                â”‚ â”‚ id         â”‚ 10019                                                                                                                                                                                                 â”‚ â”‚     â”‚
â”‚   â”‚                â”‚ â”‚ country    â”‚ United Kingdom                                                                                                                                                                                        â”‚ â”‚     â”‚
â”‚   â”‚                â”‚ â”‚ city       â”‚ Gillingham                                                                                                                                                                                            â”‚ â”‚     â”‚
â”‚   â”‚                â”‚ â”‚ state      â”‚                                                                                                                                                                                                       â”‚ â”‚     â”‚
â”‚   â”‚                â”‚ â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯ â”‚     â”‚
â•°â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â•¯</code></pre>
</div>
</div>
<div class="paragraph">
<p>We can use the content field to generate an embedding, and the result will be a new document that is the same as the original, with a new field containing the vector that is the result of the embedding generation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>&gt; doc get landmark_10019 | vector enrich-doc content
Embedding batch 1/1
â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ # â”‚       id       â”‚                                                                                                         content                                                                                                         â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0 â”‚ landmark_10019 â”‚ â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•® â”‚
â”‚   â”‚                â”‚ â”‚ title         â”‚ Gillingham (Kent)                                                                                                                                                                                   â”‚ â”‚
â”‚   â”‚                â”‚ â”‚ name          â”‚ Royal Engineers Museum                                                                                                                                                                              â”‚ â”‚
â”‚   â”‚                â”‚ â”‚ alt           â”‚                                                                                                                                                                                                     â”‚ â”‚
â”‚   â”‚                â”‚ â”‚ address       â”‚ Prince Arthur Road, ME4 4UG                                                                                                                                                                         â”‚ â”‚
â”‚   â”‚                â”‚ â”‚ directions    â”‚                                                                                                                                                                                                     â”‚ â”‚
â”‚   â”‚                â”‚ â”‚ phone         â”‚ +44 1634 822839                                                                                                                                                                                     â”‚ â”‚
â”‚   â”‚                â”‚ â”‚ tollfree      â”‚                                                                                                                                                                                                     â”‚ â”‚
â”‚   â”‚                â”‚ â”‚ email         â”‚                                                                                                                                                                                                     â”‚ â”‚
â”‚   â”‚                â”‚ â”‚ url           â”‚ http://www.remuseum.org.uk                                                                                                                                                                          â”‚ â”‚
â”‚   â”‚                â”‚ â”‚ hours         â”‚ Tues - Fri 9.00am to 5.00pm, Sat - Sun 11.30am - 5.00pm                                                                                                                                             â”‚ â”‚
â”‚   â”‚                â”‚ â”‚ image         â”‚                                                                                                                                                                                                     â”‚ â”‚
â”‚   â”‚                â”‚ â”‚ price         â”‚                                                                                                                                                                                                     â”‚ â”‚
â”‚   â”‚                â”‚ â”‚ content       â”‚ Adult - Â£6.99 for an Adult ticket that allows you to come back for further visits within a year (children's and concessionary tickets also available). Museum on military engineering and the       â”‚ â”‚
â”‚   â”‚                â”‚ â”‚               â”‚ history of the British Empire. A quite extensive collection that takes about half a day to see. Of most interest to fans of British and military history or civil engineering. The outside          â”‚ â”‚
â”‚   â”‚                â”‚ â”‚               â”‚ collection of tank mounted bridges etc can be seen for free. There is also an extensive series of themed special event weekends, admission to which is included in the cost of the annual ticket.   â”‚ â”‚
â”‚   â”‚                â”‚ â”‚               â”‚ â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®                                                                                                                                                                   â”‚ â”‚
â”‚   â”‚                â”‚ â”‚ geo           â”‚ â”‚ lat      â”‚ 51.39              â”‚                                                                                                                                                                   â”‚ â”‚
â”‚   â”‚                â”‚ â”‚               â”‚ â”‚ lon      â”‚ 0.54               â”‚                                                                                                                                                                   â”‚ â”‚
â”‚   â”‚                â”‚ â”‚               â”‚ â”‚ accuracy â”‚ RANGE_INTERPOLATED â”‚                                                                                                                                                                   â”‚ â”‚
â”‚   â”‚                â”‚ â”‚               â”‚ â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯                                                                                                                                                                   â”‚ â”‚
â”‚   â”‚                â”‚ â”‚ activity      â”‚ see                                                                                                                                                                                                 â”‚ â”‚
â”‚   â”‚                â”‚ â”‚ type          â”‚ landmark                                                                                                                                                                                            â”‚ â”‚
â”‚   â”‚                â”‚ â”‚ id            â”‚ 10019                                                                                                                                                                                               â”‚ â”‚
â”‚   â”‚                â”‚ â”‚ country       â”‚ United Kingdom                                                                                                                                                                                      â”‚ â”‚
â”‚   â”‚                â”‚ â”‚ city          â”‚ Gillingham                                                                                                                                                                                          â”‚ â”‚
â”‚   â”‚                â”‚ â”‚ state         â”‚                                                                                                                                                                                                     â”‚ â”‚
â”‚   â”‚                â”‚ â”‚               â”‚ â•­â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â•®                                                                                                                                                                                    â”‚ â”‚
â”‚   â”‚                â”‚ â”‚ contentVector â”‚ â”‚    0 â”‚  0.02 â”‚                                                                                                                                                                                    â”‚ â”‚
â”‚   â”‚                â”‚ â”‚               â”‚ â”‚  ... â”‚   ... â”‚                                                                                                                                                                                    â”‚ â”‚
â”‚   â”‚                â”‚ â”‚               â”‚ â”‚ 1535 â”‚ -0.01 â”‚                                                                                                                                                                                    â”‚ â”‚
â”‚   â”‚                â”‚ â”‚               â”‚ â•°â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â•¯                                                                                                                                                                                    â”‚ â”‚
â”‚   â”‚                â”‚ â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯ â”‚
â•°â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯</code></pre>
</div>
</div>
<div class="paragraph">
<p>The resulting document is the same as the original, but with a new field <code>contentVector</code> which contains the result of embedding the content field with the <a href="#_cb_env_llm">active llm</a>.
The name of the field that the embedding will be written to will default to the name of the original field with "Vector" appended.
This default behavior can be overwritten with the <code>vectorField</code> flag.
The resulting document is formatted with an id and content column which allows it to be piped into a <code>doc upsert</code> command to store it in the connected couchbase cluster.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>&gt; doc get landmark_10019 | vector enrich-doc content | doc upsert
Embedding batch 1/1
â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ # â”‚ processed â”‚ success â”‚ failed â”‚ failures â”‚ cluster â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0 â”‚         1 â”‚       1 â”‚      0 â”‚          â”‚ local   â”‚
â•°â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>vector enrich-doc</code> can enrich more than one document at a time.
To repeat what we have done above on all the landmark documents we can get all the docs using a query and pipe the result directly into the <code>enrich-doc</code> command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>&gt; query &quot;SELECT meta().id, * FROM `travel-sample` WHERE type = 'landmark'&quot; | vector enrich-doc content</code></pre>
</div>
</div>
<div class="paragraph">
<p>When using the result of a query as the input to <code>enrich-doc</code> you need to query for the document id as well as the contents, hence "SELECT meta().id, *".
This allows the new document output by the command to have the same id as the original.
If there is another field in the doc that you want to use as the id in the resulting documents then just select this and specify the field with the <code>--id-column</code> flag.
For example to use the "name" field as the id of the resulting documents do:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>&gt; query &quot;SELECT name, * FROM `travel-sample` WHERE type = 'landmark'&quot; | vector enrich-doc content --id-column name</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_vector_enrich_text">4.8.4. <code>vector enrich-text</code></h4>
<div class="paragraph">
<p>Generates an embedding from the input text using the <a href="#_cb_env_llm">active_llm</a> and outputs a json document containing the source text and the embedding.</p>
</div>
<div class="paragraph">
<p>It can be used directly on strings, which can be passed in as a positional parameter:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>&gt; vector enrich-text &quot;some string&quot; --dimension 5
Embedding batch 1/1
â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ # â”‚      id       â”‚          content           â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0 â”‚ vector-c9e02c â”‚ â•­â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•® â”‚
â”‚   â”‚               â”‚ â”‚ text   â”‚ some string   â”‚ â”‚
â”‚   â”‚               â”‚ â”‚        â”‚ â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â•® â”‚ â”‚
â”‚   â”‚               â”‚ â”‚ vector â”‚ â”‚ 0 â”‚  0.31 â”‚ â”‚ â”‚
â”‚   â”‚               â”‚ â”‚        â”‚ â”‚ 1 â”‚ -0.61 â”‚ â”‚ â”‚
â”‚   â”‚               â”‚ â”‚        â”‚ â”‚ 2 â”‚ -0.21 â”‚ â”‚ â”‚
â”‚   â”‚               â”‚ â”‚        â”‚ â”‚ 3 â”‚ -0.59 â”‚ â”‚ â”‚
â”‚   â”‚               â”‚ â”‚        â”‚ â”‚ 4 â”‚ -0.38 â”‚ â”‚ â”‚
â”‚   â”‚               â”‚ â”‚        â”‚ â•°â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â•¯ â”‚ â”‚
â”‚   â”‚               â”‚ â•°â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯ â”‚
â•°â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯</code></pre>
</div>
</div>
<div class="paragraph">
<p>Or piped directly in:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>&gt; &quot;some string&quot; | vector enrich-text --dimension 5
Embedding batch 1/1
â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ # â”‚      id       â”‚          content           â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0 â”‚ vector-a269a7 â”‚ â•­â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•® â”‚
â”‚   â”‚               â”‚ â”‚ text   â”‚ some string   â”‚ â”‚
â”‚   â”‚               â”‚ â”‚        â”‚ â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â•® â”‚ â”‚
â”‚   â”‚               â”‚ â”‚ vector â”‚ â”‚ 0 â”‚  0.31 â”‚ â”‚ â”‚
â”‚   â”‚               â”‚ â”‚        â”‚ â”‚ 1 â”‚ -0.61 â”‚ â”‚ â”‚
â”‚   â”‚               â”‚ â”‚        â”‚ â”‚ 2 â”‚ -0.21 â”‚ â”‚ â”‚
â”‚   â”‚               â”‚ â”‚        â”‚ â”‚ 3 â”‚ -0.59 â”‚ â”‚ â”‚
â”‚   â”‚               â”‚ â”‚        â”‚ â”‚ 4 â”‚ -0.38 â”‚ â”‚ â”‚
â”‚   â”‚               â”‚ â”‚        â”‚ â•°â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â•¯ â”‚ â”‚
â”‚   â”‚               â”‚ â•°â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯ â”‚
â•°â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that the dimension used here (5) is unrealistically low, but has just been chosen for illustrative purposes.</p>
</div>
<div class="paragraph">
<p>The output is in a format that means it can be piped directly into a <code>doc upsert</code> command to upsert it into the cluster:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>&gt; &quot;some string&quot; | vector enrich-text --dimension 5 | doc upsert
Embedding batch 1/1
â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ # â”‚ processed â”‚ success â”‚ failed â”‚ failures â”‚ cluster â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0 â”‚         1 â”‚       1 â”‚      0 â”‚          â”‚ local   â”‚
â•°â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯</code></pre>
</div>
</div>
<div class="paragraph">
<p>Or the output can be piped directly into <code>vector search</code> to find indexed docs with a similar vector.
This makes <code>vector enrich-text</code> a very easy way to experiment with similarity search using strings.
See <a href="#_vector_search">vector search</a> for an example of this.</p>
</div>
<div class="paragraph">
<p><code>vector enrich-text</code> can also be used on larger chunks of text to produce multiple <code>vector docs</code> at once.
For example say you have a text file called <code>some-text.txt</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>&gt; open some-text.txt | vector enrich-text | doc upsert
Embedding batch 1/1
â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ # â”‚ processed â”‚ success â”‚ failed â”‚ failures â”‚ cluster â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0 â”‚        92 â”‚      92 â”‚      0 â”‚          â”‚ local   â”‚
â•°â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯</code></pre>
</div>
</div>
<div class="paragraph">
<p>When used on larger amounts of text <code>vector enrich-text</code> will split it into chunks of length 1024 by default, the length of the chunks can be changed with the <code>--chunks</code> flag.
In this example the contents of <code>some-text.txt</code> was split into 92 chunks, resulting in 92 <code>vector docs</code> that were then upserted into the connected cluster.</p>
</div>
<div class="paragraph">
<p>Finally if you have a set of files within a directory that you want to generate <code>vector docs</code> from then you can list the files in the current directory with <code>ls</code> and pipe this list into <code>vector enrich-text</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>&gt; ls | vector enrich-text | doc upsert
Embedding batch 1/1
â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ # â”‚ processed â”‚ success â”‚ failed â”‚ failures â”‚ cluster â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0 â”‚       278 â”‚     278 â”‚      0 â”‚          â”‚ local   â”‚
â•°â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯</code></pre>
</div>
</div>
<div class="paragraph">
<p>Here <code>vector enrich-text</code> will read each file, chunk the contents, retrieve the embeddings then generate the <code>vector docs</code>.
Check this <a href="https://couchbase.sh/docs/recipes.html#_simple_rag">recipe</a> to see how <code>vector enrich-text</code> enables the implementation of simple Retrieval Augmented Generation.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_ask">4.9. <code>ask</code></h3>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>&gt; ask --help
Asks a connected LLM a question, optionally enhanced with context

Usage:
  &gt; ask {flags} &lt;question&gt; (context)

Flags:
  -h, --help - Display the help message for this command
  --model &lt;String&gt; - the chat model to ask the question

Parameters:
  question &lt;string&gt;: the question to be asked
  context &lt;any&gt;: table of strings used as context for the question (optional)</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>ask</code> can be used to ask a question of the <a href="#_cb_env_llm">active large language model</a>.
It can be used to answer a standalone question:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>&gt; ask &quot;What is my favourite color&quot;
I'm sorry, but as an assistant, I don't have access to personal information about you, such as your favorite color. If you'd like to share it with me, I'd be happy to remember it for future reference!</code></pre>
</div>
</div>
<div class="paragraph">
<p>Or context can be provided for the question as a list of strings.
Either as a positional parameter:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>&gt; ask &quot;What is my favourite color&quot; [&quot;My favourite color is blue&quot;]
Your favourite color is blue.</code></pre>
</div>
</div>
<div class="paragraph">
<p>This context can also be piped into the command which allows us to ask questions about docs in our database:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>ğŸ‘¤ Charlie ğŸ  local in ğŸ—„ travel-sample._default._default
&gt; subdoc get content landmark_10019 | select content | ask &quot;How much does it cost to go here?&quot;
The admission price for an adult ticket is Â£6.99, which allows you to come back for further visits within a year. There are also tickets available for children and concessionary rates. Additionally, there is a collection of tank-mounted bridges and other outside attractions that can be seen for free. Special event weekends are included in the cost of the annual ticket.</code></pre>
</div>
</div>
<div class="paragraph">
<p>Since the context can be a list we can also use <code>ask</code> to summarize the results from various documents:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>ğŸ‘¤ Charlie ğŸ  local in ğŸ—„ travel-sample._default._default
&gt; [landmark_10019 landmark_10020] | subdoc get content | select content | ask &quot;what activities can I do at these places?&quot;
At the museum on military engineering and the history of the British Empire, you can explore various exhibits related to British and military history, as well as civil engineering. Activities may include:

1. Viewing exhibits on military equipment, vehicles, weapons, and uniforms.
2. Learning about the history of the British Empire and its impact on world events.
3. Participating in guided tours to gain more in-depth knowledge.
4. Attending special event weekends with themed activities and demonstrations.
5. Exploring the outside collection of tank-mounted bridges and other military hardware.

At the new restaurant, you can enjoy the following activities:

1. Dining on a menu that features burgers and ribs.
2. Appreciating the Hollywood-style decor and ambiance.
3. Socializing with friends or family in a lively atmosphere.
4. Trying out new dishes or drinks from the restaurant's menu.
5. Relaxing and unwinding in a cozy setting after a day of exploring or sightseeing.</code></pre>
</div>
</div>
<div class="paragraph">
<p>The answering of questions with supplied context can be used to easily implement <a href="#_rag_recipe">simple RAG</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_version">4.10. <code>version</code></h3>
<div class="paragraph">
<p>The <code>version</code> command lists the version of the Couchbase shell.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>&gt; version
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ version â”‚ 0.92.0 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â•¯</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_reference">5. Reference</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_config_file_format">5.1. Config File Format</h3>
<div class="paragraph">
<p>The <code>~/.cbsh/config</code> file with examples:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="toml"># Allows us to evolve in the future without breaking old config files
version = 1

[[cluster]]
identifier = &quot;default&quot;
connstr = &quot;127.0.0.1&quot;
default-bucket = &quot;travel-sample&quot;
default-scope = &quot;my-scope&quot;
default-collection = &quot;my-collection&quot;
# The following can be part of the config or credentials
username = &quot;Administrator&quot;
password = &quot;password&quot;
# TLS defaults to on
# tls-enabled = false
# tls-cert-path = &quot;/path/to/cert&quot; # either accept all certs or provide a cert path
# tls-accept-all-certs = true
# tls-validate-hostnames = false

# User display name is optional and is used to display a different name to the username in the prompt itself.
# This can be useful if the username that you are provided is a long randomly generated string or similar.
# user-display-name = &quot;Charlie&quot;

# Timeouts broadly apply to the operations that you would expect them to.
# That is:
# * data: commands using the kv service such as `doc`
# * query: `query` commands
# * analytics: `analytics` commands
# * search: `search` commands
# * management: commands that perform management level operations, such as `users`, `bucket`, `health` etc...
data-timeout = &quot;10s&quot;
query-timeout = &quot;75s&quot;
analytics-timeout = &quot;75s&quot;
search-timeout = &quot;1m 15s&quot;
management-timeout = &quot;75s&quot;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_credentials_file_format">5.2. Credentials File Format</h3>
<div class="paragraph">
<p>The optional <code>~/.cbsh/credentials</code> file with examples:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="toml"># Allows us to evolve in the future without breaking old config files
version = 1

[[cluster]]
identifier = &quot;default&quot;
username = &quot;Administrator&quot;
password = &quot;password&quot;
# TLS defaults to on, accepting all certs
# tls-enabled = true
# tls-cert-path = &quot;/path/to/cert&quot; # either accept all certs or provide a cert path
# tls-accept-all-certs = true
# tls-validate-hostnames = false</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_importing_data">5.3. Importing data</h3>
<div class="paragraph">
<p>Couchbase Shell supports loading data from a variety of formats and sources.</p>
</div>
<div class="paragraph">
<p>The simplest way to import data is using <code>doc import</code> as covered in <a href="#_loading_data_into_the_shell">Loading data into the shell</a>.
These recipes will cover more advanced use cases.</p>
</div>
<div class="sect3">
<h4 id="_from_file">5.3.1. From file</h4>
<div class="sect4">
<h5 id="_from_json">From JSON</h5>
<div class="paragraph">
<p>Single Document</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>&gt; cat mydoc.json
{&quot;id&quot;:3719,&quot;cas&quot;:1600344369374167040,&quot;type&quot;:&quot;airport&quot;,&quot;airportname&quot;:&quot;Columbia Rgnl&quot;,&quot;city&quot;:&quot;Columbia&quot;,&quot;country&quot;:&quot;United States&quot;,&quot;faa&quot;:&quot;COU&quot;,&quot;icao&quot;:&quot;KCOU&quot;,&quot;tz&quot;:&quot;America/Chicago&quot;}

&gt; open mydoc.json | wrap content | insert id { |it|  echo $it.content.airportname } | doc upsert
â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ # â”‚ processed â”‚ success â”‚ failed â”‚ failures â”‚  cluster  â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0 â”‚         1 â”‚       1 â”‚      0 â”‚          â”‚ dev.local â”‚
â•°â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯</code></pre>
</div>
</div>
<div class="paragraph">
<p>Multiple Documents</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>&gt; ls airports
â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ # â”‚            name            â”‚ type â”‚ size  â”‚   modified    â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0 â”‚ airports/airport_3719.json â”‚ file â”‚ 353 B â”‚ 3 minutes ago â”‚
â”‚ 1 â”‚ airports/airport_3720.json â”‚ file â”‚ 355 B â”‚ 3 minutes ago â”‚
â”‚ 2 â”‚ airports/airport_3721.json â”‚ file â”‚ 370 B â”‚ 3 minutes ago â”‚
â”‚ 3 â”‚ airports/airport_3722.json â”‚ file â”‚ 362 B â”‚ 2 minutes ago â”‚
â”‚ 4 â”‚ airports/airport_3723.json â”‚ file â”‚ 365 B â”‚ 2 minutes ago â”‚
â”‚ 5 â”‚ airports/airport_3724.json â”‚ file â”‚ 356 B â”‚ 2 minutes ago â”‚
â”‚ 6 â”‚ airports/airport_3725.json â”‚ file â”‚ 350 B â”‚ 2 minutes ago â”‚
â”‚ 7 â”‚ airports/airport_3726.json â”‚ file â”‚ 362 B â”‚ 2 minutes ago â”‚
â”‚ 8 â”‚ airports/airport_3727.json â”‚ file â”‚ 371 B â”‚ 2 minutes ago â”‚
â”‚ 9 â”‚ airports/airport_3728.json â”‚ file â”‚ 354 B â”‚ 2 minutes ago â”‚
â•°â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

&gt; open airports/airport_3719.json
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ id          â”‚ 3719             â”‚
â”‚ type        â”‚ airport          â”‚
â”‚ airportname â”‚ Columbia Rgnl    â”‚
â”‚ city        â”‚ Columbia         â”‚
â”‚ country     â”‚ United States    â”‚
â”‚ faa         â”‚ COU              â”‚
â”‚ icao        â”‚ KCOU             â”‚
â”‚ tz          â”‚ America/Chicago  â”‚
â”‚             â”‚ â•­â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â•® â”‚
â”‚ geo         â”‚ â”‚ lat â”‚ 38.82  â”‚ â”‚
â”‚             â”‚ â”‚ lon â”‚ -92.22 â”‚ â”‚
â”‚             â”‚ â”‚ alt â”‚ 889    â”‚ â”‚
â”‚             â”‚ â•°â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â•¯ â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

&gt; ls airports | each { |it| open $it.name | wrap content | insert id $in.content.airportname } | doc upsert
â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ # â”‚ processed â”‚ success â”‚ failed â”‚ failures â”‚  cluster  â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0 â”‚        10 â”‚      10 â”‚      0 â”‚          â”‚ dev.local â”‚
â•°â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_from_csv">From CSV</h5>
<div class="paragraph">
<p>Single Document</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>&gt; cat mydoc.csv
id,cas,type,airportname,city,country,faa,icao,tz
3719,1600344369374167040,airport,Columbia Rgnl,Columbia,United States,COU,KCOU,America/Chicago

&gt; open mydoc.csv | each { |it| wrap content | insert id $in.content.airportname} | doc upsert
â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ # â”‚ processed â”‚ success â”‚ failed â”‚ failures â”‚  cluster  â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0 â”‚         1 â”‚       1 â”‚      0 â”‚          â”‚ dev.local â”‚
â•°â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯</code></pre>
</div>
</div>
<div class="paragraph">
<p>Multiple Documents</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>&gt; cat airports.csv
airportname,city,country,faa,icao,id,type,tz
Calais Dunkerque,Calais,France,CQF,LFAC,1254,airport,Europe/Paris
Peronne St Quentin,Peronne,France,,LFAG,1255,airport,Europe/Paris
Les Loges,Nangis,France,,LFAI,1256,airport,Europe/Paris
Couterne,Bagnole-de-l'orne,France,,LFAO,1257,airport,Europe/Paris
Bray,Albert,France,,LFAQ,1258,airport,Europe/Paris

&gt; open airports.csv | each { |it| wrap content | insert id $in.content.airportname} | doc upsert
â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ # â”‚ processed â”‚ success â”‚ failed â”‚ failures â”‚ cluster â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0 â”‚         5 â”‚       5 â”‚      0 â”‚          â”‚ local   â”‚
â•°â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_modifying_data">5.3.2. Modifying data</h4>
<div class="paragraph">
<p>In some circumstances you may want to modify the data before you import it.
Let&#8217;s take the example of importing from a csv file but this time the airports.csv file is missing the <code>type</code> column but we want to add it to our data:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>&gt; cat airports.csv
airportname,city,country,faa,icao,id,tz
Calais Dunkerque,Calais,France,CQF,LFAC,1254,Europe/Paris
Peronne St Quentin,Peronne,France,,LFAG,1255,Europe/Paris
Les Loges,Nangis,France,,LFAI,1256,Europe/Paris
Couterne,Bagnole-de-l'orne,France,,LFAO,1257,Europe/Paris
Bray,Albert,France,,LFAQ,1258,Europe/Paris

&gt; open airports.csv | insert type airport
â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ # â”‚    airportname     â”‚       city        â”‚ country â”‚ faa â”‚ icao â”‚  id  â”‚      tz      â”‚  type   â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0 â”‚ Calais Dunkerque   â”‚ Calais            â”‚ France  â”‚ CQF â”‚ LFAC â”‚ 1254 â”‚ Europe/Paris â”‚ airport â”‚
â”‚ 1 â”‚ Peronne St Quentin â”‚ Peronne           â”‚ France  â”‚     â”‚ LFAG â”‚ 1255 â”‚ Europe/Paris â”‚ airport â”‚
â”‚ 2 â”‚ Les Loges          â”‚ Nangis            â”‚ France  â”‚     â”‚ LFAI â”‚ 1256 â”‚ Europe/Paris â”‚ airport â”‚
â”‚ 3 â”‚ Couterne           â”‚ Bagnole-de-l'orne â”‚ France  â”‚     â”‚ LFAO â”‚ 1257 â”‚ Europe/Paris â”‚ airport â”‚
â”‚ 4 â”‚ Bray               â”‚ Albert            â”‚ France  â”‚     â”‚ LFAQ â”‚ 1258 â”‚ Europe/Paris â”‚ airport â”‚
â•°â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯</code></pre>
</div>
</div>
<div class="paragraph">
<p>We can also add a column based on data from other columns, for instance adding a <code>type</code> column which is set to the relevant country:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>&gt; open airports.csv | each { |it| insert type $it.city }
â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ # â”‚    airportname     â”‚       city        â”‚ country â”‚ faa â”‚ icao â”‚  id  â”‚      tz      â”‚       type        â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0 â”‚ Calais Dunkerque   â”‚ Calais            â”‚ France  â”‚ CQF â”‚ LFAC â”‚ 1254 â”‚ Europe/Paris â”‚ Calais            â”‚
â”‚ 1 â”‚ Peronne St Quentin â”‚ Peronne           â”‚ France  â”‚     â”‚ LFAG â”‚ 1255 â”‚ Europe/Paris â”‚ Peronne           â”‚
â”‚ 2 â”‚ Les Loges          â”‚ Nangis            â”‚ France  â”‚     â”‚ LFAI â”‚ 1256 â”‚ Europe/Paris â”‚ Nangis            â”‚
â”‚ 3 â”‚ Couterne           â”‚ Bagnole-de-l'orne â”‚ France  â”‚     â”‚ LFAO â”‚ 1257 â”‚ Europe/Paris â”‚ Bagnole-de-l'orne â”‚
â”‚ 4 â”‚ Bray               â”‚ Albert            â”‚ France  â”‚     â”‚ LFAQ â”‚ 1258 â”‚ Europe/Paris â”‚ Albert            â”‚
â•°â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_exporting_data">5.4. Exporting data</h3>
<div class="paragraph">
<p>Couchbase Shell supports exporting data to a variety of formats and sources.</p>
</div>
<div class="sect3">
<h4 id="_a_note_on_data_format">5.4.1. A Note On Data format</h4>
<div class="paragraph">
<p>The <code>doc get</code> command exposes data as three fields; <code>id</code>, <code>cas</code>, and <code>content</code>.
The body of the document is stored within the <code>content</code> column.
If you want to only store the document body then you can use <code>doc get &lt;id&gt; | get content</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_to_file">5.4.2. To file</h4>
<div class="sect4">
<h5 id="_to_json">To JSON</h5>
<div class="paragraph">
<p>From key-value</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>&gt; doc get airport_3719 --bucket travel-sample
â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ # â”‚      id      â”‚              content               â”‚         cas         â”‚ error â”‚ cluster â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0 â”‚ airport_3719 â”‚ â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•® â”‚ 1712321632867319808 â”‚       â”‚ local   â”‚
â”‚   â”‚              â”‚ â”‚ id          â”‚ 3719             â”‚ â”‚                     â”‚       â”‚         â”‚
â”‚   â”‚              â”‚ â”‚ type        â”‚ airport          â”‚ â”‚                     â”‚       â”‚         â”‚
â”‚   â”‚              â”‚ â”‚ airportname â”‚ Columbia Rgnl    â”‚ â”‚                     â”‚       â”‚         â”‚
â”‚   â”‚              â”‚ â”‚ city        â”‚ Columbia         â”‚ â”‚                     â”‚       â”‚         â”‚
â”‚   â”‚              â”‚ â”‚ country     â”‚ United States    â”‚ â”‚                     â”‚       â”‚         â”‚
â”‚   â”‚              â”‚ â”‚ faa         â”‚ COU              â”‚ â”‚                     â”‚       â”‚         â”‚
â”‚   â”‚              â”‚ â”‚ icao        â”‚ KCOU             â”‚ â”‚                     â”‚       â”‚         â”‚
â”‚   â”‚              â”‚ â”‚ tz          â”‚ America/Chicago  â”‚ â”‚                     â”‚       â”‚         â”‚
â”‚   â”‚              â”‚ â”‚             â”‚ â•­â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â•® â”‚ â”‚                     â”‚       â”‚         â”‚
â”‚   â”‚              â”‚ â”‚ geo         â”‚ â”‚ lat â”‚ 38.82  â”‚ â”‚ â”‚                     â”‚       â”‚         â”‚
â”‚   â”‚              â”‚ â”‚             â”‚ â”‚ lon â”‚ -92.22 â”‚ â”‚ â”‚                     â”‚       â”‚         â”‚
â”‚   â”‚              â”‚ â”‚             â”‚ â”‚ alt â”‚ 889.00 â”‚ â”‚ â”‚                     â”‚       â”‚         â”‚
â”‚   â”‚              â”‚ â”‚             â”‚ â•°â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â•¯ â”‚ â”‚                     â”‚       â”‚         â”‚
â”‚   â”‚              â”‚ â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯ â”‚                     â”‚       â”‚         â”‚
â•°â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

&gt; doc get airport_3719 | get content.0 | save mydoc.json
ğŸ‘¤ Charlie ğŸ  local
&gt; cat mydoc.json
{
  &quot;id&quot;: 3719,
  &quot;type&quot;: &quot;airport&quot;,
  &quot;airportname&quot;: &quot;Columbia Rgnl&quot;,
  &quot;city&quot;: &quot;Columbia&quot;,
  &quot;country&quot;: &quot;United States&quot;,
  &quot;faa&quot;: &quot;COU&quot;,
  &quot;icao&quot;: &quot;KCOU&quot;,
  &quot;tz&quot;: &quot;America/Chicago&quot;,
  &quot;geo&quot;:
  {
    &quot;lat&quot;: 38.818094,
    &quot;lon&quot;: -92.219631,
    &quot;alt&quot;: 889
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>From Query/Analytics</p>
</div>
<div class="paragraph">
<p>To Single Document</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>&gt;  query &quot;SELECT `travel-sample`.* from `travel-sample` WHERE `type`='airport' LIMIT 5&quot;
â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ # â”‚       airportname       â”‚       city        â”‚    country    â”‚ faa â”‚        geo        â”‚ icao â”‚  id  â”‚  type   â”‚         tz          â”‚ cluster â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0 â”‚ Boeing Fld King Co Intl â”‚ Seattle           â”‚ United States â”‚ BFI â”‚ â•­â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â•® â”‚ KBFI â”‚ 3726 â”‚ airport â”‚ America/Los_Angeles â”‚ local   â”‚
â”‚   â”‚                         â”‚                   â”‚               â”‚     â”‚ â”‚ alt â”‚ 21      â”‚ â”‚      â”‚      â”‚         â”‚                     â”‚         â”‚
â”‚   â”‚                         â”‚                   â”‚               â”‚     â”‚ â”‚ lat â”‚ 47.53   â”‚ â”‚      â”‚      â”‚         â”‚                     â”‚         â”‚
â”‚   â”‚                         â”‚                   â”‚               â”‚     â”‚ â”‚ lon â”‚ -122.30 â”‚ â”‚      â”‚      â”‚         â”‚                     â”‚         â”‚
â”‚   â”‚                         â”‚                   â”‚               â”‚     â”‚ â•°â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯ â”‚      â”‚      â”‚         â”‚                     â”‚         â”‚
â”‚ 1 â”‚ Bray                    â”‚ Albert            â”‚ France        â”‚     â”‚        â         â”‚ LFAQ â”‚ 1258 â”‚ airport â”‚ Europe/Paris        â”‚ local   â”‚
â”‚ 2 â”‚ Calais Dunkerque        â”‚ Calais            â”‚ France        â”‚ CQF â”‚        â         â”‚ LFAC â”‚ 1254 â”‚ airport â”‚ Europe/Paris        â”‚ local   â”‚
â”‚ 3 â”‚ Columbia Rgnl           â”‚ Columbia          â”‚ United States â”‚ COU â”‚ â•­â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â•®  â”‚ KCOU â”‚ 3719 â”‚ airport â”‚ America/Chicago     â”‚ local   â”‚
â”‚   â”‚                         â”‚                   â”‚               â”‚     â”‚ â”‚ alt â”‚ 889    â”‚  â”‚      â”‚      â”‚         â”‚                     â”‚         â”‚
â”‚   â”‚                         â”‚                   â”‚               â”‚     â”‚ â”‚ lat â”‚ 38.82  â”‚  â”‚      â”‚      â”‚         â”‚                     â”‚         â”‚
â”‚   â”‚                         â”‚                   â”‚               â”‚     â”‚ â”‚ lon â”‚ -92.22 â”‚  â”‚      â”‚      â”‚         â”‚                     â”‚         â”‚
â”‚   â”‚                         â”‚                   â”‚               â”‚     â”‚ â•°â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â•¯  â”‚      â”‚      â”‚         â”‚                     â”‚         â”‚
â”‚ 4 â”‚ Couterne                â”‚ Bagnole-de-l'orne â”‚ France        â”‚     â”‚        â         â”‚ LFAO â”‚ 1257 â”‚ airport â”‚ Europe/Paris        â”‚ local   â”‚
â•°â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

&gt; query &quot;SELECT `travel-sample`.* from `travel-sample` WHERE `type`='airport' LIMIT 5&quot; | save airports.json
&gt; cat airports.json
[
  {
    &quot;airportname&quot;: &quot;Boeing Fld King Co Intl&quot;,
    &quot;city&quot;: &quot;Seattle&quot;,
    &quot;country&quot;: &quot;United States&quot;,
    &quot;faa&quot;: &quot;BFI&quot;,
    &quot;geo&quot;:
    {
      &quot;alt&quot;: 21,
      &quot;lat&quot;: 47.53,
      &quot;lon&quot;: -122.301947
    },
    &quot;icao&quot;: &quot;KBFI&quot;,
    &quot;id&quot;: 3726,
    &quot;type&quot;: &quot;airport&quot;,
    &quot;tz&quot;: &quot;America/Los_Angeles&quot;,
    &quot;cluster&quot;: &quot;local&quot;
  },
...
  {
    &quot;airportname&quot;: &quot;Couterne&quot;,
    &quot;city&quot;: &quot;Bagnole-de-l'orne&quot;,
    &quot;country&quot;: &quot;France&quot;,
    &quot;faa&quot;: &quot;&quot;,
    &quot;icao&quot;: &quot;LFAO&quot;,
    &quot;id&quot;: 1257,
    &quot;type&quot;: &quot;airport&quot;,
    &quot;tz&quot;: &quot;Europe/Paris&quot;,
    &quot;cluster&quot;: &quot;local&quot;
  }
]</code></pre>
</div>
</div>
<div class="paragraph">
<p>To Multiple Documents</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>&gt; query &quot;SELECT `travel-sample`.* from `travel-sample` WHERE `type`='airport' LIMIT 5&quot;
â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ # â”‚       airportname       â”‚       city        â”‚    country    â”‚ faa â”‚        geo        â”‚ icao â”‚  id  â”‚  type   â”‚         tz          â”‚ cluster â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0 â”‚ Boeing Fld King Co Intl â”‚ Seattle           â”‚ United States â”‚ BFI â”‚ â•­â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â•® â”‚ KBFI â”‚ 3726 â”‚ airport â”‚ America/Los_Angeles â”‚ local   â”‚
â”‚   â”‚                         â”‚                   â”‚               â”‚     â”‚ â”‚ alt â”‚ 21      â”‚ â”‚      â”‚      â”‚         â”‚                     â”‚         â”‚
â”‚   â”‚                         â”‚                   â”‚               â”‚     â”‚ â”‚ lat â”‚ 47.53   â”‚ â”‚      â”‚      â”‚         â”‚                     â”‚         â”‚
â”‚   â”‚                         â”‚                   â”‚               â”‚     â”‚ â”‚ lon â”‚ -122.30 â”‚ â”‚      â”‚      â”‚         â”‚                     â”‚         â”‚
â”‚   â”‚                         â”‚                   â”‚               â”‚     â”‚ â•°â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯ â”‚      â”‚      â”‚         â”‚                     â”‚         â”‚
â”‚ 1 â”‚ Bray                    â”‚ Albert            â”‚ France        â”‚     â”‚        â         â”‚ LFAQ â”‚ 1258 â”‚ airport â”‚ Europe/Paris        â”‚ local   â”‚
â”‚ 2 â”‚ Calais Dunkerque        â”‚ Calais            â”‚ France        â”‚ CQF â”‚        â         â”‚ LFAC â”‚ 1254 â”‚ airport â”‚ Europe/Paris        â”‚ local   â”‚
â”‚ 3 â”‚ Columbia Rgnl           â”‚ Columbia          â”‚ United States â”‚ COU â”‚ â•­â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â•®  â”‚ KCOU â”‚ 3719 â”‚ airport â”‚ America/Chicago     â”‚ local   â”‚
â”‚   â”‚                         â”‚                   â”‚               â”‚     â”‚ â”‚ alt â”‚ 889    â”‚  â”‚      â”‚      â”‚         â”‚                     â”‚         â”‚
â”‚   â”‚                         â”‚                   â”‚               â”‚     â”‚ â”‚ lat â”‚ 38.82  â”‚  â”‚      â”‚      â”‚         â”‚                     â”‚         â”‚
â”‚   â”‚                         â”‚                   â”‚               â”‚     â”‚ â”‚ lon â”‚ -92.22 â”‚  â”‚      â”‚      â”‚         â”‚                     â”‚         â”‚
â”‚   â”‚                         â”‚                   â”‚               â”‚     â”‚ â•°â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â•¯  â”‚      â”‚      â”‚         â”‚                     â”‚         â”‚
â”‚ 4 â”‚ Couterne                â”‚ Bagnole-de-l'orne â”‚ France        â”‚     â”‚        â         â”‚ LFAO â”‚ 1257 â”‚ airport â”‚ Europe/Paris        â”‚ local   â”‚
â•°â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

&gt; query &quot;SELECT `travel-sample`.* FROM `travel-sample` WHERE `type`='airport' LIMIT 5&quot; | each { |it| $it | save ([&quot;airport_&quot;, $it.id ,&quot;.json&quot;] | str join) }
&gt; ls airport*.json
â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ # â”‚       name        â”‚ type â”‚ size  â”‚ modified â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0 â”‚ airport_1254.json â”‚ file â”‚ 197 B â”‚ now      â”‚
â”‚ 1 â”‚ airport_1257.json â”‚ file â”‚ 197 B â”‚ now      â”‚
â”‚ 2 â”‚ airport_1258.json â”‚ file â”‚ 182 B â”‚ now      â”‚
â”‚ 3 â”‚ airport_3719.json â”‚ file â”‚ 284 B â”‚ now      â”‚
â”‚ 4 â”‚ airport_3726.json â”‚ file â”‚ 293 B â”‚ now      â”‚
â•°â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_to_csv">To CSV</h5>
<div class="paragraph">
<p>From key-value</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>&gt; doc get airport_3719 --bucket travel-sample
â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ # â”‚      id      â”‚              content               â”‚         cas         â”‚ error â”‚ cluster â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0 â”‚ airport_3719 â”‚ â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•® â”‚ 1712321632867319808 â”‚       â”‚ local   â”‚
â”‚   â”‚              â”‚ â”‚ id          â”‚ 3719             â”‚ â”‚                     â”‚       â”‚         â”‚
â”‚   â”‚              â”‚ â”‚ type        â”‚ airport          â”‚ â”‚                     â”‚       â”‚         â”‚
â”‚   â”‚              â”‚ â”‚ airportname â”‚ Columbia Rgnl    â”‚ â”‚                     â”‚       â”‚         â”‚
â”‚   â”‚              â”‚ â”‚ city        â”‚ Columbia         â”‚ â”‚                     â”‚       â”‚         â”‚
â”‚   â”‚              â”‚ â”‚ country     â”‚ United States    â”‚ â”‚                     â”‚       â”‚         â”‚
â”‚   â”‚              â”‚ â”‚ faa         â”‚ COU              â”‚ â”‚                     â”‚       â”‚         â”‚
â”‚   â”‚              â”‚ â”‚ icao        â”‚ KCOU             â”‚ â”‚                     â”‚       â”‚         â”‚
â”‚   â”‚              â”‚ â”‚ tz          â”‚ America/Chicago  â”‚ â”‚                     â”‚       â”‚         â”‚
â”‚   â”‚              â”‚ â”‚             â”‚ â•­â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â•® â”‚ â”‚                     â”‚       â”‚         â”‚
â”‚   â”‚              â”‚ â”‚ geo         â”‚ â”‚ lat â”‚ 38.82  â”‚ â”‚ â”‚                     â”‚       â”‚         â”‚
â”‚   â”‚              â”‚ â”‚             â”‚ â”‚ lon â”‚ -92.22 â”‚ â”‚ â”‚                     â”‚       â”‚         â”‚
â”‚   â”‚              â”‚ â”‚             â”‚ â”‚ alt â”‚ 889.00 â”‚ â”‚ â”‚                     â”‚       â”‚         â”‚
â”‚   â”‚              â”‚ â”‚             â”‚ â•°â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â•¯ â”‚ â”‚                     â”‚       â”‚         â”‚
â”‚   â”‚              â”‚ â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯ â”‚                     â”‚       â”‚         â”‚
â•°â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

&gt; doc get airport_3719 --bucket travel-sample | get content
â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ # â”‚  id  â”‚  type   â”‚  airportname  â”‚   city   â”‚    country    â”‚ faa â”‚ icao â”‚       tz        â”‚       geo        â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0 â”‚ 3719 â”‚ airport â”‚ Columbia Rgnl â”‚ Columbia â”‚ United States â”‚ COU â”‚ KCOU â”‚ America/Chicago â”‚ â•­â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â•® â”‚
â”‚   â”‚      â”‚         â”‚               â”‚          â”‚               â”‚     â”‚      â”‚                 â”‚ â”‚ lat â”‚ 38.82  â”‚ â”‚
â”‚   â”‚      â”‚         â”‚               â”‚          â”‚               â”‚     â”‚      â”‚                 â”‚ â”‚ lon â”‚ -92.22 â”‚ â”‚
â”‚   â”‚      â”‚         â”‚               â”‚          â”‚               â”‚     â”‚      â”‚                 â”‚ â”‚ alt â”‚ 889.00 â”‚ â”‚
â”‚   â”‚      â”‚         â”‚               â”‚          â”‚               â”‚     â”‚      â”‚                 â”‚ â•°â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â•¯ â”‚
â•°â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>geo</code> column in the above data contains a <code>record</code>, which means that the data is nested.
This means that we have to flatten out the <code>geo</code> column due to limitations of the csv format.
If we try to import the content as it is then we will see:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>&gt; doc get airport_3719 --bucket travel-sample | get content | to csv
Error: nu::shell::cant_convert (link)

  Ã— Can't convert to CSV.
   â•­â”€[entry #25:1:1]
 1 â”‚ doc get airport_3719 --bucket travel-sample | get content | to csv
   Â· â”€â”€â”€â”¬â”€â”€â”€
   Â·    â•°â”€â”€ can't convert table&lt;airportname: string, city: string, country: string, faa: string, geo: record&lt;alt: float, lat: float, lon: float&gt;, icao: string, id: int, type: string, tz: string&gt; to CSV
   â•°â”€â”€â”€â”€</code></pre>
</div>
</div>
<div class="paragraph">
<p>To flatten out the data we can simply use the <code>flatten</code> command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>&gt; doc get airport_3719 --bucket travel-sample | get content | flatten
â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ # â”‚  id  â”‚  type   â”‚  airportname  â”‚   city   â”‚    country    â”‚ faa â”‚ icao â”‚       tz        â”‚  lat  â”‚  lon   â”‚  alt   â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0 â”‚ 3719 â”‚ airport â”‚ Columbia Rgnl â”‚ Columbia â”‚ United States â”‚ COU â”‚ KCOU â”‚ America/Chicago â”‚ 38.82 â”‚ -92.22 â”‚ 889.00 â”‚
â•°â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â•¯</code></pre>
</div>
</div>
<div class="paragraph">
<p>Which we can then pipe to save:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>&gt; doc get airport_3719 --bucket travel-sample | get content | flatten | save mydoc.csv
&gt; cat mydoc.csv
id,type,airportname,city,country,faa,icao,tz,lat,lon,alt
3719,airport,Columbia Rgnl,Columbia,United States,COU,KCOU,America/Chicago,38.818094,-92.219631,889</code></pre>
</div>
</div>
<div class="paragraph">
<p>From Query/Analytics</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>&gt; query &quot;SELECT `travel-sample`.* from `travel-sample` WHERE `type`='airport' LIMIT 5&quot;
â•­â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ # â”‚       airportname       â”‚       city        â”‚    country    â”‚ faa â”‚        geo        â”‚ icao â”‚  id  â”‚  type   â”‚         tz          â”‚ cluster â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0 â”‚ Boeing Fld King Co Intl â”‚ Seattle           â”‚ United States â”‚ BFI â”‚ â•­â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â•® â”‚ KBFI â”‚ 3726 â”‚ airport â”‚ America/Los_Angeles â”‚ local   â”‚
â”‚   â”‚                         â”‚                   â”‚               â”‚     â”‚ â”‚ alt â”‚ 21      â”‚ â”‚      â”‚      â”‚         â”‚                     â”‚         â”‚
â”‚   â”‚                         â”‚                   â”‚               â”‚     â”‚ â”‚ lat â”‚ 47.53   â”‚ â”‚      â”‚      â”‚         â”‚                     â”‚         â”‚
â”‚   â”‚                         â”‚                   â”‚               â”‚     â”‚ â”‚ lon â”‚ -122.30 â”‚ â”‚      â”‚      â”‚         â”‚                     â”‚         â”‚
â”‚   â”‚                         â”‚                   â”‚               â”‚     â”‚ â•°â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯ â”‚      â”‚      â”‚         â”‚                     â”‚         â”‚
â”‚ 1 â”‚ Bray                    â”‚ Albert            â”‚ France        â”‚     â”‚        â         â”‚ LFAQ â”‚ 1258 â”‚ airport â”‚ Europe/Paris        â”‚ local   â”‚
â”‚ 2 â”‚ Calais Dunkerque        â”‚ Calais            â”‚ France        â”‚ CQF â”‚        â         â”‚ LFAC â”‚ 1254 â”‚ airport â”‚ Europe/Paris        â”‚ local   â”‚
â”‚ 3 â”‚ Columbia Rgnl           â”‚ Columbia          â”‚ United States â”‚ COU â”‚ â•­â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â•®  â”‚ KCOU â”‚ 3719 â”‚ airport â”‚ America/Chicago     â”‚ local   â”‚
â”‚   â”‚                         â”‚                   â”‚               â”‚     â”‚ â”‚ alt â”‚ 889    â”‚  â”‚      â”‚      â”‚         â”‚                     â”‚         â”‚
â”‚   â”‚                         â”‚                   â”‚               â”‚     â”‚ â”‚ lat â”‚ 38.82  â”‚  â”‚      â”‚      â”‚         â”‚                     â”‚         â”‚
â”‚   â”‚                         â”‚                   â”‚               â”‚     â”‚ â”‚ lon â”‚ -92.22 â”‚  â”‚      â”‚      â”‚         â”‚                     â”‚         â”‚
â”‚   â”‚                         â”‚                   â”‚               â”‚     â”‚ â•°â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â•¯  â”‚      â”‚      â”‚         â”‚                     â”‚         â”‚
â”‚ 4 â”‚ Couterne                â”‚ Bagnole-de-l'orne â”‚ France        â”‚     â”‚        â         â”‚ LFAO â”‚ 1257 â”‚ airport â”‚ Europe/Paris        â”‚ local   â”‚
â•°â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯</code></pre>
</div>
</div>
<div class="paragraph">
<p>Similar to the above we need to flatten out the <code>geo</code> data before we can save this to csv:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>&gt; query &quot;SELECT `travel-sample`.* from `travel-sample` WHERE `type`='airport' LIMIT 5&quot; | flatten | save mydoc.csv
&gt; cat mydoc.csv
airportname,city,country,faa,alt,lat,lon,icao,id,type,tz,cluster
Boeing Fld King Co Intl,Seattle,United States,BFI,21,47.53,-122.301947,KBFI,3726,airport,America/Los_Angeles,local
Bray,Albert,France,,,,,LFAQ,1258,airport,Europe/Paris,local
Calais Dunkerque,Calais,France,CQF,,,,LFAC,1254,airport,Europe/Paris,local
Columbia Rgnl,Columbia,United States,COU,889,38.818094,-92.219631,KCOU,3719,airport,America/Chicago,local
Couterne,Bagnole-de-l'orne,France,,,,,LFAO,1257,airport,Europe/Paris,local</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_release_notes">6. Release Notes</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_1_0_0_2024_09_11">6.1. 1.0.0 - 2024-09-11</h3>
<div class="ulist">
<ul>
<li>
<p>Nushell pinned to 0.95</p>
</li>
<li>
<p>Added <code>vector</code> commands</p>
</li>
<li>
<p>Added support for bucket creation/management on Capella clusters</p>
</li>
<li>
<p>Added support for loading sample data onto Capella clusters</p>
</li>
<li>
<p>Added support for sub doc reads</p>
</li>
<li>
<p>Added integration with large language models from Google, AWS and OpenAI</p>
</li>
<li>
<p>Added support for named and positional query parameters</p>
</li>
<li>
<p>Support document ids being ints for <code>doc</code> commands</p>
</li>
<li>
<p>Support no expiry for collections</p>
</li>
<li>
<p>Unset scope/collection when higher level entity changed</p>
</li>
<li>
<p>Supports creation and management of Capella Clusters</p>
</li>
<li>
<p>Added support for credential creation against Capella clusters</p>
</li>
<li>
<p>Added support for creation of allowed CIDRs against Capella clusters</p>
</li>
<li>
<p>Take username and password securely when using <code>cb-env register</code></p>
</li>
<li>
<p>Added support for managing Capella projects</p>
</li>
<li>
<p>Added support for listing Capella organizations</p>
</li>
<li>
<p>Enable use of <code>$nu</code> inside scripts and commands passed to cbsh</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_0_75_2_2023_04_10">6.2. 0.75.2 - 2023-04-10</h3>
<div class="ulist">
<ul>
<li>
<p>Updated macOS build to not have any dependency on OpenSSL.</p>
</li>
<li>
<p>Fixed the release workflow so that Linux release tarballs contain the <code>cbsh</code> binary.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_0_75_1_2023_04_13">6.3. 0.75.1 - 2023-04-13</h3>
<div class="paragraph">
<p><strong>This release contains a number of breaking changes, which are explicitly called out below.</strong>
As our versioning continues to track the underlying Nushell minor version this has required breaking changes in a patch version.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Updated config file to rename <code><a id="cluster"></a></code> to <code><a id="database"></a></code> (<code><a id="cluster"></a></code> will continue to work).</p>
</li>
<li>
<p><strong>Breaking</strong> Updated config file to rename <code>hostnames</code> to <code>connstr</code> and changed the format to be a string.</p>
</li>
<li>
<p>Added support, and detection, for different "cluster types"; Capella and Other. This allows us to modify behavior based on cluster type.</p>
</li>
<li>
<p><strong>Breaking</strong> Renamed <code>clusters health</code> to <code>health</code>.</p>
</li>
<li>
<p><strong>Breaking</strong> Renamed other <code>clusters &#8230;&#8203;</code> commands to <code>database &#8230;&#8203;</code></p>
</li>
<li>
<p>Replaced references to cluster with database.</p>
</li>
<li>
<p><strong>Breaking</strong> Removed support for whoami</p>
</li>
<li>
<p>Added support for username aliases - added <code>display_name</code> to config.</p>
</li>
<li>
<p>Trust the system store and Capella root CA when no certificate set.</p>
</li>
<li>
<p>Updated tutorial.</p>
</li>
<li>
<p>Added support for generating a config file when one does not exist.</p>
</li>
<li>
<p>Added support for connecting to kv nodes in parallel.</p>
</li>
<li>
<p>Added support for <code>doc import</code> command.</p>
</li>
<li>
<p>Added prompt indicator to help distinguish if a Capella or "other" cluster type is in use.</p>
</li>
<li>
<p>Fast fail <code>buckets</code> commands when used with Capella.</p>
</li>
<li>
<p>Updated where config files are automatically written to.</p>
</li>
<li>
<p>Fixed issue with config.nu file on Windows.</p>
<div class="ulist">
<ul>
<li>
<p>Pulled all beta and alpha release versions and updated version numbering</p>
</li>
<li>
<p>Couchbase Shell versions will now map to the Nushell version being used</p>
</li>
<li>
<p>Bundle Capella root CA to allow seamlessly connecting over TLS</p>
</li>
<li>
<p>Automatically detect when <code>query_context</code> should be sent</p>
</li>
<li>
<p>Update when SRV lookups are performed</p>
</li>
<li>
<p>Statically link OpenSSL</p>
</li>
<li>
<p>Various logging and error enhancements</p>
</li>
<li>
<p>Remove support for Capella InVpc</p>
</li>
<li>
<p>Renamed <code>clusters managed</code> to <code>cb-env managed</code></p>
</li>
<li>
<p>Renamed <code>clusters register/unregister</code> to <code>cb-env register/unregister</code></p>
</li>
<li>
<p>Expose CIDR in result of <code>clusters</code></p>
</li>
<li>
<p>Fetch collection id over memcached rather than http</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_0_75_0_2023_02_09">6.4. 0.75.0 - 2023-02-09</h3>
<div class="ulist">
<ul>
<li>
<p>Nushell pinned to 0.75</p>
</li>
<li>
<p>Pulled all beta and alpha release versions and updated version numbering</p>
</li>
<li>
<p>Couchbase Shell versions will now map to the Nushell version being used</p>
</li>
<li>
<p>Bundle Capella root CA to allow seamlessly connecting over TLS</p>
</li>
<li>
<p>Automatically detect when <code>query_context</code> should be sent</p>
</li>
<li>
<p>Update when SRV lookups are performed</p>
</li>
<li>
<p>Statically link OpenSSL</p>
</li>
<li>
<p>Various logging and error enhancements</p>
</li>
<li>
<p>Remove support for Capella InVpc</p>
</li>
<li>
<p>Renamed <code>clusters managed</code> to <code>cb-env managed</code></p>
</li>
<li>
<p>Renamed <code>clusters register/unregister</code> to <code>cb-env register/unregister</code></p>
</li>
<li>
<p>Expose CIDR in result of <code>clusters</code></p>
</li>
<li>
<p>Fetch collection id over memcached rather than http</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2024-09-27 13:08:58 UTC
</div>
</div>
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
        })(window,document,'script','dataLayer','GTM-MVPNN2');</script>
      <script>
        if (window.self === window.top) {
          var s = document.createElement("script");
          s.src = "https://cdn.cookielaw.org/scripttemplates/otSDKStub.js";
          s.setAttribute("data-domain-script", "a3f24ada-7dfd-4533-8672-6014ad300642");
          document.body.appendChild(s);
        }
      </script>
      <script type="text/javascript">
        function OptanonWrapper() { }
      </script>
</body>
</html>